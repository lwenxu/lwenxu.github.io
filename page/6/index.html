<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/page/6/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 5.2.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-Linux/Apache配置虚拟主机" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/01/03/Linux/Apache%E9%85%8D%E7%BD%AE%E8%99%9A%E6%8B%9F%E4%B8%BB%E6%9C%BA/" class="article-date">
  <time datetime="2019-01-03T11:08:33.000Z" itemprop="datePublished">2019-01-03</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%9C%8D%E5%8A%A1%E5%99%A8/">服务器</a>►<a class="article-category-link" href="/categories/%E6%9C%8D%E5%8A%A1%E5%99%A8/Linux/">Linux</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/01/03/Linux/Apache%E9%85%8D%E7%BD%AE%E8%99%9A%E6%8B%9F%E4%B8%BB%E6%9C%BA/">Apache配置详解</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="1-虚拟主机概念"><a href="#1-虚拟主机概念" class="headerlink" title="1. 虚拟主机概念"></a>1. 虚拟主机概念</h1><p>我们要想实现一个web站点，而且能够在互联网上被访问，首先它再能运行在操作系统，而且这个操作系统还要运行在物理主机上（第一它是一个主机）。在互联网上能够被访问，那我们需要一个主机，需要一个IP地址，需要一个时时在线的服务器，这需要多少资源？对众多小型站点来讲或者说对某种需求来讲，有可能都用不到服务器，也就是每天就10个人左右访问，只是需要我们在线而已，如果我们就为这一点点的需求就投入重大的资源的话是非常浪费的。我们就期望能够像我们使用虚拟机一样，虚拟的OS一样或虚拟的PC一样，能够在一台物理主机上虚拟出来多个可以同时运行的站点或者我们把它称为主机因此就把它称为虚拟主机。</p>
<h1 id="2-Apache-主机的类型"><a href="#2-Apache-主机的类型" class="headerlink" title="2. Apache 主机的类型"></a>2. Apache 主机的类型</h1><h3 id="1-中心主机"><a href="#1-中心主机" class="headerlink" title="1. 中心主机"></a>1. 中心主机</h3><h3 id="2-虚拟主机"><a href="#2-虚拟主机" class="headerlink" title="2. 虚拟主机"></a>2. 虚拟主机</h3><ol>
<li><p>基于IP: 端口相同，IP地址不同。</p>
</li>
<li><p>基于端口：IP相同，端口不同。</p>
</li>
<li><p>基于域名：IP地址相同，端口相同主机名不同</p>
</li>
</ol>
<p><strong>注意：所有的虚拟主机的配置我们都需要取消中心主机，也就是注释掉 DocumentRoot 这是配置虚拟主机的前提</strong></p>
<h1 id="3-基于域名的虚拟主机"><a href="#3-基于域名的虚拟主机" class="headerlink" title="3. 基于域名的虚拟主机"></a>3. 基于域名的虚拟主机</h1><p>例如我采用的 xampp 所以配置虚拟主机就在 <code>C:\xampp\apache\conf\extra\httpd-vhosts.conf</code> 中配置，由于这个文件默认被 include 到主配置文件中了，所以在这里的修改都可以生效。</p>
<p>首先需要保证主配置文件中的中心主机被取消了也就是：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#DocumentRoot &quot;C:/xampp/htdocs&quot;</span></span><br></pre></td></tr></table></figure>

<p>然后打开 <code>httpd-vhosts.conf</code> 配置文件，按照下面的格式配置虚拟主机</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;VirtualHost *:80&gt;</span><br><span class="line">	DocumentRoot &quot;C:&#x2F;xampp&#x2F;htdocs&quot;</span><br><span class="line">	ServerName localhost</span><br><span class="line">	&lt;Directory &quot;C:&#x2F;xampp&#x2F;htdocs&quot;&gt;</span><br><span class="line">		Options Indexes FollowSymLinks Includes ExecCGI</span><br><span class="line">		AllowOverride All</span><br><span class="line">		Require all granted</span><br><span class="line">	&lt;&#x2F;Directory&gt;</span><br><span class="line">&lt;&#x2F;VirtualHost&gt;</span><br></pre></td></tr></table></figure>

<h2 id="1-lt-VirtualHost-80-gt"><a href="#1-lt-VirtualHost-80-gt" class="headerlink" title="1.  &lt;VirtualHost *:80&gt;"></a>1.  <code>&lt;VirtualHost *:80&gt;</code></h2><p> apache监听本机的所有 IP 和 80 端口做多域名虚拟主机</p>
<h2 id="2-DocumentRoot"><a href="#2-DocumentRoot" class="headerlink" title="2. DocumentRoot"></a>2. DocumentRoot</h2><p>表示服务器的根目录</p>
<h2 id="3-ServerName"><a href="#3-ServerName" class="headerlink" title="3. ServerName"></a>3. ServerName</h2><p>就是表示域名，我们采用域名方式配置虚拟主机，所以每个虚拟主机的域名应该是不一样的才行</p>
<h2 id="4-Directory"><a href="#4-Directory" class="headerlink" title="4. Directory"></a>4. Directory</h2><p>对根目录的规则应用，其中涉及到对于目录的访问权限和其他配置问题</p>
<h2 id="5-对于-Directory-指令解析"><a href="#5-对于-Directory-指令解析" class="headerlink" title="5. 对于 Directory 指令解析"></a>5. 对于 Directory 指令解析</h2><h3 id="1-Options"><a href="#1-Options" class="headerlink" title="1.  Options"></a>1.  Options</h3><p>配置在特定目录使用哪些特性，常用的值和基本含义如下</p>
<ol>
<li>ExecCGI: 在该目录下允许执行CGI脚本。</li>
<li>FollowSymLinks: 在该目录下允许文件系统使用符号连接。</li>
<li>Indexes: 当用户访问该目录时，如果用户找不到DirectoryIndex指定的主页文件(例如index.html),则返回该目录下的文件列表给用户。</li>
<li>SymLinksIfOwnerMatch: 当使用符号连接时，只有当符号连接的文件拥有者与实际文件的拥有者相同时才可以访问。</li>
</ol>
<p>所以我们一般在配置 PHP 的时候所配置的内容是</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Options Indexes FollowSymLinks Includes ExecCGI</span><br></pre></td></tr></table></figure>

<h3 id="2-AllowOverride"><a href="#2-AllowOverride" class="headerlink" title="2. AllowOverride"></a>2. AllowOverride</h3><p>允许存在于.htaccess文件中的指令类型(.htaccess文件名是可以改变的，其文件名由AccessFileName指令决定)：</p>
<ul>
<li>None: 当AllowOverride被设置为None时。不搜索该目录下的.htaccess文件（可以减小服务器开销）。</li>
<li>All: 在.htaccess文件中可以使用所有的指令。</li>
</ul>
<p>建议关闭这个选项，因为apache在文档中已经明确支持不建议使用它了，主要是会降低服务器性能，.htaccess 文件可以做到的我们都可以在 Directory 指令中做的更好。</p>
<h3 id="3-Order"><a href="#3-Order" class="headerlink" title="3. Order"></a>3. Order</h3><p>控制在访问时Allow和Deny两个访问规则哪个优先，也就是黑白名单的匹配顺序</p>
<ul>
<li>Allow：允许访问的主机列表(可用域名或子网，例如：Allow from 192.168.0.0/16)。</li>
<li>Deny：拒绝访问的主机列表。</li>
</ul>
<blockquote>
<p>更详细的用法可参看：<a target="_blank" rel="noopener" href="https://httpd.apache.org/docs/trunk/zh-cn/mod/mod_access_compat.html#order">order用法</a></p>
</blockquote>
<p>匹配原则：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Allow,Deny</span><br></pre></td></tr></table></figure>

<p>First, all <code>Allow</code> directives are evaluated; at least one must match, or the request is rejected. Next, all <code>Deny</code> directives are evaluated. If any matches, the request is rejected. Last, any requests which do not match an <code>Allow</code> or a <code>Deny</code> directive are denied by default.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Deny,Allow</span><br></pre></td></tr></table></figure>

<p>First, all <code>Deny</code> directives are evaluated; if any match, the request is denied <strong>unless</strong> it also matches an <code>Allow</code> directive. Any requests which do not match any <code>Allow</code> or <code>Deny</code> directives are permitted.</p>
<h3 id="4-DirectoryIndex"><a href="#4-DirectoryIndex" class="headerlink" title="4. DirectoryIndex"></a>4. DirectoryIndex</h3><p>主页文件设置 一般都是 index.html  index.php</p>
<h3 id="5-Deny-Allow"><a href="#5-Deny-Allow" class="headerlink" title="5. Deny /Allow"></a>5. Deny /Allow</h3><p>黑白名单书写规则如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Allow from example.org</span><br><span class="line">Allow from .net example.edu</span><br><span class="line">Allow from 10.1.2.3</span><br><span class="line">Allow from 192.168.1.104 192.168.1.205</span><br><span class="line">Allow all</span><br></pre></td></tr></table></figure>

<h1 id="4-基于端口的虚拟主机"><a href="#4-基于端口的虚拟主机" class="headerlink" title="4. 基于端口的虚拟主机"></a>4. 基于端口的虚拟主机</h1><p>对于同一个 ip 来做虚拟主机，就是需要监听不同的端口，首先需要在主配置文件中添加新的监听端口：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Listen 80</span><br><span class="line">Listen 81</span><br></pre></td></tr></table></figure>

<p>然后再虚拟主机里面配置</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;Virtualhost *:80&gt;</span><br><span class="line">	DocumentRoot &quot;&#x2F;var1&quot;</span><br><span class="line">&lt;&#x2F;Virtualhost&gt;</span><br><span class="line">&lt;Virtualhost *:81&gt;</span><br><span class="line">	DocumentRoot &quot;&#x2F;var2&quot;</span><br><span class="line">&lt;&#x2F;Virtualhost&gt;</span><br></pre></td></tr></table></figure>

<h1 id="5-基于ip的虚拟主机"><a href="#5-基于ip的虚拟主机" class="headerlink" title="5. 基于ip的虚拟主机"></a>5. 基于ip的虚拟主机</h1><p>这个就不过多赘述了，完全和基于端口的配置方式一样。也就是修改的是ip 而非端口、</p>
<h1 id="6-服务器的优化-MPM-Multi-Processing-Modules"><a href="#6-服务器的优化-MPM-Multi-Processing-Modules" class="headerlink" title="6.服务器的优化 (MPM: Multi-Processing Modules)"></a>6.服务器的优化 (MPM: Multi-Processing Modules)</h1><p>apache2主要的优势就是对多处理器的支持更好，在编译时同过使用–with-mpm选项来决定apache2的工作模式。如果知道当前的apache2使用什么工作机制，可以通过httpd -l命令列出apache的所有模块，就可以知道其工作方式：</p>
<ul>
<li><p>prefork：如果httpd -l列出prefork.c，则需要对下面的段进行配置。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;IfModule prefork.c&gt;</span><br><span class="line"> StartServers 5 #启动apache时启动的httpd进程个数。</span><br><span class="line"> MinSpareServers 5 #服务器保持的最小空闲进程数。</span><br><span class="line"> MaxSpareServers 10 #服务器保持的最大空闲进程数。</span><br><span class="line"> MaxClients 150 #最大并发连接数。</span><br><span class="line"> MaxRequestsPerChild 1000 #每个子进程被请求服务多少次后被kill掉。0表示不限制，推荐设置为1000。</span><br><span class="line"> &lt;&#x2F;IfModule&gt;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<p>在该工作模式下，服务器启动后起动5个httpd进程(加父进程共6个，通过ps -ax|grep httpd命令可以看到)。当有用户连接时，apache会使用一个空闲进程为该连接服务，同时父进程会fork一个子进程。直到内存中的空闲进程达到MaxSpareServers。该模式是为了兼容一些旧版本的程序。我缺省编译时的选项。</p>
<ul>
<li>worker：如果httpd -l列出worker.c，则需要对下面的段进行配置：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;IfModule worker.c&gt; </span><br><span class="line">    StartServers 2 #启动apache时启动的httpd进程个数。 </span><br><span class="line">    MaxClients 150 #最大并发连接数。 </span><br><span class="line">    MinSpareThreads 25 #服务器保持的最小空闲线程数。 </span><br><span class="line">    MaxSpareThreads 75 #服务器保持的最大空闲线程数。 </span><br><span class="line">    ThreadsPerChild 25 #每个子进程的产生的线程数。 </span><br><span class="line">    MaxRequestsPerChild 0 #每个子进程被请求服务多少次后被kill掉。0表示不限制，推荐设置为1000。 </span><br><span class="line">&lt;&#x2F;IfModule&gt; </span><br></pre></td></tr></table></figure>

<p>该模式是由线程来监听客户的连接。当有新客户连接时，由其中的一个空闲线程接受连接。服务器在启动时启动两个进程，每个进程产生的线程数是固定的(ThreadsPerChild决定)，因此启动时有50个线程。当50个线程不够用时，服务器自动fork一个进程，再产生25个线程。</p>
<ul>
<li>perchild：如果httpd -l列出perchild.c，则需要对下面的段进行配置：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;IfModule perchild.c&gt; </span><br><span class="line">    NumServers 5 #服务器启动时启动的子进程数 </span><br><span class="line">    StartThreads 5 #每个子进程启动时启动的线程数 </span><br><span class="line">    MinSpareThreads 5 #内存中的最小空闲线程数 </span><br><span class="line">    MaxSpareThreads 10 #最大空闲线程数 </span><br><span class="line">    MaxThreadsPerChild 2000 #每个线程最多被请求多少次后退出。0不受限制。 </span><br><span class="line">    MaxRequestsPerChild 10000 #每个子进程服务多少次后被重新fork。0表示不受限制。 </span><br><span class="line">&lt;&#x2F;IfModule&gt; </span><br></pre></td></tr></table></figure>

<p>该模式下，子进程的数量是固定的，线程数不受限制。当客户端连接到服务器时，又空闲的线程提供服务。 如果空闲线程数不够，子进程自动产生线程来为新的连接服务。该模式用于多站点服务器。</p>
<h1 id="7-别名设置"><a href="#7-别名设置" class="headerlink" title="7.别名设置"></a>7.别名设置</h1><p>对于不在DocumentRoot指定的目录内的页面，既可以使用符号连接，也可以使用别名。别名的设置如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Alias &#x2F;download&#x2F; &quot;&#x2F;var&#x2F;www&#x2F;download&#x2F;&quot; #访问时可以输入:http:&#x2F;&#x2F;www.custing.com&#x2F;download&#x2F; </span><br><span class="line"> </span><br><span class="line">&lt;Directory &quot;&#x2F;var&#x2F;www&#x2F;download&quot;&gt; #对该目录进行访问控制设置 </span><br><span class="line">    Options Indexes MultiViews </span><br><span class="line">    AllowOverride AuthConfig </span><br><span class="line">    Order allow,deny </span><br><span class="line">    Allow from all </span><br><span class="line">&lt;&#x2F;Directory&gt;</span><br></pre></td></tr></table></figure>

<h4 id="6、CGI设置"><a href="#6、CGI设置" class="headerlink" title="6、CGI设置"></a>6、CGI设置</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># 访问时可以：http:&#x2F;&#x2F;www.clusting.com&#x2F;cgi-bin&#x2F;，但是该目录下的CGI脚本文件要加可执行权限</span><br><span class="line">ScriptAlias &#x2F;cgi-bin&#x2F; &quot;&#x2F;mnt&#x2F;software&#x2F;apache2&#x2F;cgi-bin&#x2F;&quot; </span><br><span class="line"> </span><br><span class="line">&lt;Directory &quot;&#x2F;usr&#x2F;local&#x2F;apache2&#x2F;cgi-bin&quot;&gt; #设置目录属性 </span><br><span class="line">    AllowOverride None </span><br><span class="line">    Options None </span><br><span class="line">    Order allow,deny </span><br><span class="line">    Allow from all </span><br><span class="line">&lt;&#x2F;Directory&gt; </span><br></pre></td></tr></table></figure>

<h1 id="8、日志的设置"><a href="#8、日志的设置" class="headerlink" title="8、日志的设置"></a>8、日志的设置</h1><h5 id="1-错误日志的设置"><a href="#1-错误日志的设置" class="headerlink" title="(1) 错误日志的设置"></a>(1) 错误日志的设置</h5><ul>
<li><p>ErrorLog logs/error_log :日志的保存位置</p>
</li>
<li><p>LogLevel warn #日志的级别</p>
</li>
</ul>
<p>显示的格式日下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[Mon Oct 10 15:54:29 2005] [error] [client 192.168.10.22] access to &#x2F;download&#x2F; failed, reason: user admin not allowed access </span><br></pre></td></tr></table></figure>

<h5 id="2-访问日志设置"><a href="#2-访问日志设置" class="headerlink" title="(2) 访问日志设置"></a>(2) 访问日志设置</h5><p>日志的缺省格式有如下几种：</p>
<ul>
<li>LogFormat “%h %l %u %t “%r” %&gt;s %b “%{Referer}i” “%{User-Agent}i”” combined</li>
<li>LogFormat “%h %l %u %t “%r” %&gt;s %b” common #common为日志格式名称</li>
<li>LogFormat “%{Referer}i -&gt; %U” referer</li>
<li>LogFormat “%{User-agent}i” agent</li>
<li>CustomLog logs/access_log common</li>
</ul>
<p>格式中的各个参数如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">%h --客户端的ip地址或主机名 </span><br><span class="line">%l --The 这是由客户端 identd 判断的RFC 1413身份，输出中的符号 &quot;-&quot; 表示此处信息无效。 </span><br><span class="line">%u --由HTTP认证系统得到的访问该网页的客户名。有认证时才有效，输出中的符号 &quot;-&quot; 表示此处信息无效。 </span><br><span class="line">%t --服务器完成对请求的处理时的时间。 </span><br><span class="line">&quot;%r&quot; --引号中是客户发出的包含了许多有用信息的请求内容。 </span><br><span class="line">%&gt;s --这个是服务器返回给客户端的状态码。 </span><br><span class="line">%b --最后这项是返回给客户端的不包括响应头的字节数。 </span><br><span class="line">&quot;%&#123;Referer&#125;i&quot; --此项指明了该请求是从被哪个网页提交过来的。 </span><br><span class="line">&quot;%&#123;User-Agent&#125;i&quot; --此项是客户浏览器提供的浏览器识别信息。 </span><br></pre></td></tr></table></figure>

<p>下面是一段访问日志的实例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">192.168.10.22 - bearzhang [10&#x2F;Oct&#x2F;2005:16:53:06 +0800] &quot;GET &#x2F;download&#x2F; HTTP&#x2F;1.1&quot; 200 1228 </span><br><span class="line">192.168.10.22 - - [10&#x2F;Oct&#x2F;2005:16:53:06 +0800] &quot;GET &#x2F;icons&#x2F;blank.gif HTTP&#x2F;1.1&quot; 304 - </span><br><span class="line">192.168.10.22 - - [10&#x2F;Oct&#x2F;2005:16:53:06 +0800] &quot;GET &#x2F;icons&#x2F;back.gif HTTP&#x2F;1.1&quot; 304 – </span><br></pre></td></tr></table></figure>

<h1 id="9、用户认证的配置"><a href="#9、用户认证的配置" class="headerlink" title="9、用户认证的配置"></a>9、用户认证的配置</h1><h5 id="1-httpd-conf用户认证配置"><a href="#1-httpd-conf用户认证配置" class="headerlink" title="(1) httpd.conf用户认证配置:"></a>(1) httpd.conf用户认证配置:</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">AccessFileName .htaccess </span><br><span class="line">......... </span><br><span class="line">Alias &#x2F;download&#x2F; &quot;&#x2F;var&#x2F;www&#x2F;download&#x2F;&quot; </span><br><span class="line">&lt;Directory &quot;&#x2F;var&#x2F;www&#x2F;download&quot;&gt; </span><br><span class="line">    Options Indexes </span><br><span class="line">    AllowOverride AuthConfig </span><br><span class="line">&lt;&#x2F;Directory&gt; </span><br></pre></td></tr></table></figure>

<h5 id="2-create-a-password-file"><a href="#2-create-a-password-file" class="headerlink" title="(2) create a password file:"></a>(2) create a password file:</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;usr&#x2F;local&#x2F;apache2&#x2F;bin&#x2F;htpasswd -c &#x2F;var&#x2F;httpuser&#x2F;passwords bearzhang</span><br></pre></td></tr></table></figure>



<h5 id="3-configure-the-server-to-request-a-password-and-tell-the-server-which-users-are-allowed-access"><a href="#3-configure-the-server-to-request-a-password-and-tell-the-server-which-users-are-allowed-access" class="headerlink" title="(3) configure the server to request a password and tell the server which users are allowed access."></a>(3) configure the server to request a password and tell the server which users are allowed access.</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">vi &#x2F;var&#x2F;www&#x2F;download&#x2F;.htaccess: </span><br><span class="line"> </span><br><span class="line">AuthType Basic </span><br><span class="line">AuthName &quot;Restricted Files&quot; </span><br><span class="line">AuthUserFile &#x2F;var&#x2F;httpuser&#x2F;passwords </span><br><span class="line">Require user bearzhang </span><br><span class="line">#Require valid-user #all valid user </span><br></pre></td></tr></table></figure>

<h1 id="10、虚拟主机的配置总结"><a href="#10、虚拟主机的配置总结" class="headerlink" title="10、虚拟主机的配置总结"></a>10、虚拟主机的配置总结</h1><h5 id="1-基于IP地址的虚拟主机配置"><a href="#1-基于IP地址的虚拟主机配置" class="headerlink" title="(1)基于IP地址的虚拟主机配置"></a>(1)基于IP地址的虚拟主机配置</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Listen 80 </span><br><span class="line"> </span><br><span class="line">&lt;VirtualHost 172.20.30.40&gt; </span><br><span class="line">    DocumentRoot &#x2F;www&#x2F;example1 </span><br><span class="line">    ServerName www.example1.com </span><br><span class="line">&lt;&#x2F;VirtualHost&gt; </span><br><span class="line"> </span><br><span class="line">&lt;VirtualHost 172.20.30.50&gt; </span><br><span class="line">    DocumentRoot &#x2F;www&#x2F;example2 </span><br><span class="line">    ServerName www.example2.org </span><br><span class="line">&lt;&#x2F;VirtualHost&gt; </span><br></pre></td></tr></table></figure>

<h5 id="2-基于IP和多端口的虚拟主机配置"><a href="#2-基于IP和多端口的虚拟主机配置" class="headerlink" title="(2) 基于IP和多端口的虚拟主机配置"></a>(2) 基于IP和多端口的虚拟主机配置</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">Listen 172.20.30.40:80 </span><br><span class="line">Listen 172.20.30.40:8080 </span><br><span class="line">Listen 172.20.30.50:80 </span><br><span class="line">Listen 172.20.30.50:8080 </span><br><span class="line"> </span><br><span class="line">&lt;VirtualHost 172.20.30.40:80&gt; </span><br><span class="line">    DocumentRoot &#x2F;www&#x2F;example1-80 </span><br><span class="line">    ServerName www.example1.com </span><br><span class="line">&lt;&#x2F;VirtualHost&gt; </span><br><span class="line"> </span><br><span class="line">&lt;VirtualHost 172.20.30.40:8080&gt; </span><br><span class="line">    DocumentRoot &#x2F;www&#x2F;example1-8080</span><br><span class="line">    ServerName www.example1.com </span><br><span class="line">&lt;&#x2F;VirtualHost&gt; </span><br><span class="line"> </span><br><span class="line">&lt;VirtualHost 172.20.30.50:80&gt; </span><br><span class="line">    DocumentRoot &#x2F;www&#x2F;example2-80 </span><br><span class="line">    ServerName www.example1.org </span><br><span class="line">&lt;&#x2F;VirtualHost&gt; </span><br><span class="line"> </span><br><span class="line">&lt;VirtualHost 172.20.30.50:8080&gt; </span><br><span class="line">    DocumentRoot &#x2F;www&#x2F;example2-8080 </span><br><span class="line">    ServerName www.example2.org </span><br><span class="line">&lt;&#x2F;VirtualHost&gt; </span><br></pre></td></tr></table></figure>

<h5 id="3-单个IP地址的服务器上基于域名的虚拟主机配置："><a href="#3-单个IP地址的服务器上基于域名的虚拟主机配置：" class="headerlink" title="(3) 单个IP地址的服务器上基于域名的虚拟主机配置："></a>(3) 单个IP地址的服务器上基于域名的虚拟主机配置：</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"># Ensure that Apache listens on port 80 </span><br><span class="line">Listen 80 </span><br><span class="line"> </span><br><span class="line"># Listen for virtual host requests on all IP addresses </span><br><span class="line">NameVirtualHost *:80 </span><br><span class="line"> </span><br><span class="line">&lt;VirtualHost *:80&gt; </span><br><span class="line">    DocumentRoot &#x2F;www&#x2F;example1 </span><br><span class="line">    ServerName www.example1.com </span><br><span class="line">    ServerAlias example1.com. *.example1.com </span><br><span class="line">    # Other directives here </span><br><span class="line">&lt;&#x2F;VirtualHost&gt; </span><br><span class="line"> </span><br><span class="line">&lt;VirtualHost *:80&gt; </span><br><span class="line">    DocumentRoot &#x2F;www&#x2F;example2 </span><br><span class="line">    ServerName www.example2.org </span><br><span class="line">    # Other directives here </span><br><span class="line">&lt;&#x2F;VirtualHost&gt; </span><br></pre></td></tr></table></figure>

<h5 id="4-在多个IP地址的服务器上配置基于域名的虚拟主机："><a href="#4-在多个IP地址的服务器上配置基于域名的虚拟主机：" class="headerlink" title="(4) 在多个IP地址的服务器上配置基于域名的虚拟主机："></a>(4) 在多个IP地址的服务器上配置基于域名的虚拟主机：</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">Listen 80 </span><br><span class="line"> </span><br><span class="line"># This is the &quot;main&quot; server running on 172.20.30.40 </span><br><span class="line">ServerName server.domain.com </span><br><span class="line">DocumentRoot &#x2F;www&#x2F;mainserver </span><br><span class="line"> </span><br><span class="line"># This is the other address </span><br><span class="line">NameVirtualHost 172.20.30.50 </span><br><span class="line"> </span><br><span class="line">&lt;VirtualHost 172.20.30.50&gt; </span><br><span class="line">    DocumentRoot &#x2F;www&#x2F;example1 </span><br><span class="line">    ServerName www.example1.com </span><br><span class="line">    # Other directives here ... </span><br><span class="line">&lt;&#x2F;VirtualHost&gt; </span><br><span class="line"> </span><br><span class="line">&lt;VirtualHost 172.20.30.50&gt; </span><br><span class="line">    DocumentRoot &#x2F;www&#x2F;example2 </span><br><span class="line">    ServerName www.example2.org </span><br><span class="line">    # Other directives here ... </span><br><span class="line">&lt;&#x2F;VirtualHost&gt; </span><br></pre></td></tr></table></figure>

<h5 id="5-在不同的端口上运行不同的站点-基于多端口的服务器上配置基于域名的虚拟主机-："><a href="#5-在不同的端口上运行不同的站点-基于多端口的服务器上配置基于域名的虚拟主机-：" class="headerlink" title="(5) 在不同的端口上运行不同的站点(基于多端口的服务器上配置基于域名的虚拟主机)："></a>(5) 在不同的端口上运行不同的站点(基于多端口的服务器上配置基于域名的虚拟主机)：</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">Listen 80 </span><br><span class="line">Listen 8080 </span><br><span class="line"> </span><br><span class="line">NameVirtualHost 172.20.30.40:80 </span><br><span class="line">NameVirtualHost 172.20.30.40:8080 </span><br><span class="line"></span><br><span class="line">&lt;VirtualHost 172.20.30.40:80&gt; </span><br><span class="line">    ServerName www.example1.com </span><br><span class="line">    DocumentRoot &#x2F;www&#x2F;domain-80 </span><br><span class="line">&lt;&#x2F;VirtualHost&gt; </span><br><span class="line"> </span><br><span class="line">&lt;VirtualHost 172.20.30.40:8080&gt; </span><br><span class="line">    ServerName www.example1.com</span><br><span class="line">    DocumentRoot &#x2F;www&#x2F;domain-8080 </span><br><span class="line">&lt;&#x2F;VirtualHost&gt; </span><br><span class="line"> </span><br><span class="line">&lt;VirtualHost 172.20.30.40:80&gt;</span><br><span class="line">    ServerName www.example2.org </span><br><span class="line">    DocumentRoot &#x2F;www&#x2F;otherdomain-80 </span><br><span class="line">&lt;&#x2F;VirtualHost&gt; </span><br><span class="line"> </span><br><span class="line">&lt;VirtualHost 172.20.30.40:8080&gt; </span><br><span class="line">    ServerName www.example2.org </span><br><span class="line">    DocumentRoot &#x2F;www&#x2F;otherdomain-8080 </span><br><span class="line">&lt;&#x2F;VirtualHost&gt; </span><br></pre></td></tr></table></figure>

<h5 id="6-基于域名和基于IP的混合虚拟主机的配置"><a href="#6-基于域名和基于IP的混合虚拟主机的配置" class="headerlink" title="(6) 基于域名和基于IP的混合虚拟主机的配置:"></a>(6) 基于域名和基于IP的混合虚拟主机的配置:</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">Listen 80 </span><br><span class="line"> </span><br><span class="line">NameVirtualHost 172.20.30.40 </span><br><span class="line"> </span><br><span class="line">&lt;VirtualHost 172.20.30.40&gt; </span><br><span class="line">    DocumentRoot &#x2F;www&#x2F;example1 </span><br><span class="line">    ServerName www.example1.com </span><br><span class="line">&lt;&#x2F;VirtualHost&gt; </span><br><span class="line"> </span><br><span class="line">&lt;VirtualHost 172.20.30.40&gt; </span><br><span class="line">    DocumentRoot &#x2F;www&#x2F;example2 </span><br><span class="line">    ServerName www.example2.org </span><br><span class="line">&lt;&#x2F;VirtualHost&gt; </span><br><span class="line"> </span><br><span class="line">&lt;VirtualHost 172.20.30.40&gt; </span><br><span class="line">    DocumentRoot &#x2F;www&#x2F;example3 </span><br><span class="line">    ServerName www.example3.net </span><br><span class="line">&lt;&#x2F;VirtualHost&gt; </span><br></pre></td></tr></table></figure>

<h1 id="11-SSL加密的配置"><a href="#11-SSL加密的配置" class="headerlink" title="11.SSL加密的配置"></a>11.SSL加密的配置</h1><p>首先在配置之前先来了解一些基本概念：</p>
<blockquote>
<p>a. 证书的概念：首先要有一个根证书，然后用根证书来签发服务器证书和客户证书，一般理解：服务器证书和客户证书是平级关系。SSL必须安装 服务器证书来认证。 因此：在此环境中，至少必须有三个证书：根证书，服务器证书，客户端证书。 在生成证书之前，一般会有一个私钥，同时用私钥生成证书请求，再利用证书服务器的根证来签发证书。 SSL所使用的证书可以自己生成，也可以通过一个商业性CA（如Verisign 或 Thawte）签署证书。</p>
</blockquote>
<blockquote>
<p>b. 签发证书的问题：如果使用的是商业证书，具体的签署方法请查看相关销售商的说明；如果是知己签发的证书，可以使用openssl自带的CA.sh  脚本工具。</p>
</blockquote>
<p>如果不为单独的客户端签发证书，客户端证书可以不用生成，客户端与服务器端使用相同的证书。</p>
<h4 id="1-conf-ssl-conf-配置文件中的主要参数配置如下："><a href="#1-conf-ssl-conf-配置文件中的主要参数配置如下：" class="headerlink" title="(1) conf/ssl.conf 配置文件中的主要参数配置如下："></a>(1) conf/ssl.conf 配置文件中的主要参数配置如下：</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">Listen 443 </span><br><span class="line"> </span><br><span class="line">SSLPassPhraseDialog buildin </span><br><span class="line">#SSLPassPhraseDialog exec:&#x2F;path&#x2F;to&#x2F;program </span><br><span class="line">SSLSessionCache dbm:&#x2F;usr&#x2F;local&#x2F;apache2&#x2F;logs&#x2F;ssl_scache </span><br><span class="line">SSLSessionCacheTimeout 300 </span><br><span class="line">SSLMutex file:&#x2F;usr&#x2F;local&#x2F;apache2&#x2F;logs&#x2F;ssl_mutex </span><br><span class="line"> </span><br><span class="line">&lt;VirtualHost _default_:443&gt; </span><br><span class="line"># General setup for the virtual host </span><br><span class="line">DocumentRoot &quot;&#x2F;usr&#x2F;local&#x2F;apache2&#x2F;htdocs&quot; </span><br><span class="line">ServerName www.example.com:443 </span><br><span class="line">ServerAdmin you@example.com </span><br><span class="line">ErrorLog &#x2F;usr&#x2F;local&#x2F;apache2&#x2F;logs&#x2F;error_log </span><br><span class="line">TransferLog &#x2F;usr&#x2F;local&#x2F;apache2&#x2F;logs&#x2F;access_log </span><br><span class="line">  </span><br><span class="line">SSLEngine on </span><br><span class="line">SSLCipherSuite ALL:!ADH:!EXPORT56:RC4+RSA:+HIGH:+MEDIUM:+LOW:+SSLv2:+EXP:+eNULL </span><br><span class="line">  </span><br><span class="line">SSLCertificateFile &#x2F;usr&#x2F;local&#x2F;apache2&#x2F;conf&#x2F;ssl.crt&#x2F;server.crt </span><br><span class="line">SSLCertificateKeyFile &#x2F;usr&#x2F;local&#x2F;apache2&#x2F;conf&#x2F;ssl.key&#x2F;server.key </span><br><span class="line">CustomLog &#x2F;usr&#x2F;local&#x2F;apache2&#x2F;logs&#x2F;ssl_request_log &quot;%t %h %&#123;SSL_PROTOCOL&#125;x %&#123;SSL_CIPHER&#125;x &quot;%r&quot; %b&quot; </span><br><span class="line">&lt;&#x2F;VirtualHost&gt; </span><br></pre></td></tr></table></figure>

<h4 id="2-创建和使用自签署的证书："><a href="#2-创建和使用自签署的证书：" class="headerlink" title="(2) 创建和使用自签署的证书："></a>(2) 创建和使用自签署的证书：</h4><p>a. Create a RSA private key for your Apache server</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;usr&#x2F;local&#x2F;openssl&#x2F;bin&#x2F;openssl genrsa -des3 -out &#x2F;usr&#x2F;local&#x2F;apache2&#x2F;conf&#x2F;ssl.key&#x2F;server.key 1024 </span><br></pre></td></tr></table></figure>

<p>b. Create a Certificate Signing Request (CSR)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;usr&#x2F;local&#x2F;openssl&#x2F;bin&#x2F;openssl req -new -key &#x2F;usr&#x2F;local&#x2F;apache2&#x2F;conf&#x2F;ssl.key&#x2F;server.key -out &#x2F;usr&#x2F;local&#x2F;apache2&#x2F;conf&#x2F;ssl.key&#x2F;server.csr </span><br></pre></td></tr></table></figure>

<p>c. Create a self-signed CA Certificate (X509 structure) with the RSA key of the CA</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;usr&#x2F;local&#x2F;openssl&#x2F;bin&#x2F;openssl req -x509 -days 365 -key &#x2F;usr&#x2F;local&#x2F;apache2&#x2F;conf&#x2F;ssl.key&#x2F;server.key -in &#x2F;usr&#x2F;local&#x2F;apache2&#x2F;conf&#x2F;ssl.key&#x2F;server.csr -out &#x2F;usr&#x2F;local&#x2F;apache2&#x2F;conf&#x2F;ssl.crt&#x2F;server.crt </span><br><span class="line">&#x2F;usr&#x2F;local&#x2F;openssl&#x2F;bin&#x2F;openssl genrsa 1024 -out server.key </span><br><span class="line">&#x2F;usr&#x2F;local&#x2F;openssl&#x2F;bin&#x2F;openssl req -new -key server.key -out server.csr </span><br><span class="line">&#x2F;usr&#x2F;local&#x2F;openssl&#x2F;bin&#x2F;openssl req -x509 -days 365 -key server.key -in server.csr -out server.crt </span><br></pre></td></tr></table></figure>

<h4 id="3-创建自己的CA（认证证书），并使用该CA来签署服务器的证书。"><a href="#3-创建自己的CA（认证证书），并使用该CA来签署服务器的证书。" class="headerlink" title="(3) 创建自己的CA（认证证书），并使用该CA来签署服务器的证书。"></a>(3) 创建自己的CA（认证证书），并使用该CA来签署服务器的证书。</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">mkdir &#x2F;CA </span><br><span class="line">cd &#x2F;CA </span><br><span class="line">cp openssl-0.9.7g&#x2F;apps&#x2F;CA.sh &#x2F;CA </span><br><span class="line">.&#x2F;CA.sh -newca </span><br><span class="line">openssl genrsa -des3 -out server.key 1024 </span><br><span class="line">openssl req -new -key server.key -out server.csr </span><br><span class="line">cp server.csr newreq.pem </span><br><span class="line">.&#x2F;CA.sh -sign </span><br><span class="line">cp newcert.pem &#x2F;usr&#x2F;local&#x2F;apache2&#x2F;conf&#x2F;ssl.crt&#x2F;server.crt </span><br><span class="line">cp server.key &#x2F;usr&#x2F;local&#x2F;apache2&#x2F;conf&#x2F;ssl.key&#x2F;</span><br></pre></td></tr></table></figure>

<p><strong>参考文章</strong>：</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="http://blog.51cto.com/yahoon/36239">深入理解Apache虚拟主机</a></p>
<p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/c36dd3946e74">Apache配置文件httpd.conf详解</a></p>
<p><a target="_blank" rel="noopener" href="https://httpd.apache.org/docs/trunk/zh-cn/howto/htaccess.html">Apache文档</a></p>
</blockquote>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2019/01/03/Linux/Apache%E9%85%8D%E7%BD%AE%E8%99%9A%E6%8B%9F%E4%B8%BB%E6%9C%BA/" data-id="cmblmb6c900qll6of8f0pc4ur" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux/" rel="tag">Linux</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Article/优秀文章集锦" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/12/18/Article/%E4%BC%98%E7%A7%80%E6%96%87%E7%AB%A0%E9%9B%86%E9%94%A6/" class="article-date">
  <time datetime="2018-12-18T13:01:28.000Z" itemprop="datePublished">2018-12-18</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%96%87%E7%AB%A0/">文章</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/12/18/Article/%E4%BC%98%E7%A7%80%E6%96%87%E7%AB%A0%E9%9B%86%E9%94%A6/">优秀文章集锦</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="1-安全"><a href="#1-安全" class="headerlink" title="1. 安全"></a>1. 安全</h1><p><a target="_blank" rel="noopener" href="https://www.infoq.cn/article/how-to-encrypt-the-user-password-correctly">应用程序如何正确对用户密码进行加密</a></p>
<p><a target="_blank" rel="noopener" href="https://www.ibm.com/developerworks/cn/java/j-lo-java8streamapi/index.html">Java 8 中的 Streams API 详解</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2018/12/18/Article/%E4%BC%98%E7%A7%80%E6%96%87%E7%AB%A0%E9%9B%86%E9%94%A6/" data-id="cmblmb669001il6of7g619i92" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%96%87%E7%AB%A0/" rel="tag">文章</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-SpringBoot/SpringData笔记" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/12/17/SpringBoot/SpringData%E7%AC%94%E8%AE%B0/" class="article-date">
  <time datetime="2018-12-17T21:01:28.000Z" itemprop="datePublished">2018-12-17</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/SpringBoot/">SpringBoot</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/12/17/SpringBoot/SpringData%E7%AC%94%E8%AE%B0/">SpringData笔记</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="SpringData-笔记"><a href="#SpringData-笔记" class="headerlink" title="SpringData 笔记"></a>SpringData 笔记</h1><h1 id="1-配置项目"><a href="#1-配置项目" class="headerlink" title="1. 配置项目"></a>1. 配置项目</h1><h2 id="1-pom-xml"><a href="#1-pom-xml" class="headerlink" title="1.pom.xml"></a>1.pom.xml</h2>
        
          <p class="article-more-link">
            <a href="/2018/12/17/SpringBoot/SpringData%E7%AC%94%E8%AE%B0/#more">Read More</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2018/12/17/SpringBoot/SpringData%E7%AC%94%E8%AE%B0/" data-id="cmblmb6cg00rkl6ofelilaerx" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/SpringBoot/" rel="tag">SpringBoot</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Java SE/Java设计模式" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/08/06/Java%20SE/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" class="article-date">
  <time datetime="2018-08-06T08:25:29.000Z" itemprop="datePublished">2018-08-06</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Java/">-Java</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/08/06/Java%20SE/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/">GOF23 常用设计模式</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="GOF23-常用设计模式"><a href="#GOF23-常用设计模式" class="headerlink" title="GOF23 常用设计模式"></a>GOF23 常用设计模式</h1><h2 id="一、单例设计模式"><a href="#一、单例设计模式" class="headerlink" title="一、单例设计模式"></a>一、单例设计模式</h2><h3 id="1-饿汉式"><a href="#1-饿汉式" class="headerlink" title="1.饿汉式"></a>1.饿汉式</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">public class GOF23 &#123;</span><br><span class="line">    &#x2F;&#x2F; 饿汉式</span><br><span class="line">    private static final List list &#x3D; new ArrayList();</span><br><span class="line"></span><br><span class="line">    public static List getInstance() &#123;</span><br><span class="line">        return list;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-懒汉式"><a href="#2-懒汉式" class="headerlink" title="2.懒汉式"></a>2.懒汉式</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">    &#x2F;&#x2F; 懒汉式</span><br><span class="line">    &#x2F;&#x2F; 使用双检锁，并且由于 jvm 指令重排序我们需要使用 volatile 关键字抑制指令重排序</span><br><span class="line">public class GOF&#123;</span><br><span class="line">    private static volatile List list1;</span><br><span class="line">    public static List getInstanceLazy() &#123;</span><br><span class="line">        synchronized (Object.class) &#123;</span><br><span class="line">            if (list1 &#x3D;&#x3D; null) &#123;</span><br><span class="line">                synchronized (Object.class)&#123;</span><br><span class="line">                    list1 &#x3D; new ArrayList();</span><br><span class="line">                    return list;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;else &#123;</span><br><span class="line">                return list;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-静态内部类"><a href="#3-静态内部类" class="headerlink" title="3.静态内部类"></a>3.静态内部类</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">public class GOF&#123;</span><br><span class="line">     &#x2F;&#x2F; 静态内部类</span><br><span class="line">    public static class SingletonClass&#123;</span><br><span class="line">        private static final List list2 &#x3D; new ArrayList();</span><br><span class="line">    &#125;</span><br><span class="line">    &#x2F;&#x2F; 首先要去加载这个静态内部类，然后这个时候会调用 cinit 方法这个是天然的线程安全的，然后返回这个对象即可  可以延时加载</span><br><span class="line">    public List getStaticInstance()&#123;</span><br><span class="line">        return SingletonClass.list2;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="4-枚举"><a href="#4-枚举" class="headerlink" title="4.枚举"></a>4.枚举</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">public class GOF23 &#123;</span><br><span class="line">    &#x2F;&#x2F; 采用枚举的方式  不能延时加载  由 jvm 底层完成的</span><br><span class="line">    public enum SingleInstanceEnum&#123;</span><br><span class="line">        INSTANCE_ENUM</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="二、工厂设计模式"><a href="#二、工厂设计模式" class="headerlink" title="二、工厂设计模式"></a>二、工厂设计模式</h2><p>工厂设计模式的好处就是把对象的创建和使用分开。在软公众需要遵循的三个原则：开闭原则（对修改关闭，对拓展开放）、依赖翻转（面向接口依赖而不是类的强依赖）、迪米特法则（和朋友通讯而不是陌生人）。</p>
<h3 id="1-简单工厂"><a href="#1-简单工厂" class="headerlink" title="1.简单工厂"></a>1.简单工厂</h3><p>一般也称之为静态工厂，因为他的方法是一个静态的方法，并且必须要有一个父接口去容纳这些被创建的对象。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">public interface Car &#123;</span><br><span class="line">    public void run();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public class Audi implements Car &#123;</span><br><span class="line">    @Override</span><br><span class="line">    public void run() &#123;</span><br><span class="line">        System.out.println(&quot;audi run&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public class Daben implements Car &#123;</span><br><span class="line">    @Override</span><br><span class="line">    public void run() &#123;</span><br><span class="line">        System.out.println(&quot;daben run&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public class CarFactory &#123;</span><br><span class="line">    public static Car createCar(String type) &#123;</span><br><span class="line">        if (type.equals(&quot;daben&quot;)) &#123;</span><br><span class="line">            return new Daben();</span><br><span class="line">        &#125; else if (type.equals(&quot;audi&quot;)) &#123;</span><br><span class="line">            return new Audi();</span><br><span class="line">        &#125;else &#123;</span><br><span class="line">            return null;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public class CarClient &#123;</span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        Daben daben &#x3D; (Daben) CarFactory.createCar(&quot;daben&quot;);</span><br><span class="line">        daben.run();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-工厂方法"><a href="#2-工厂方法" class="headerlink" title="2.工厂方法"></a>2.工厂方法</h3><p>这个比上面好一点的就是我们不用直接修改原来的代码而是可以面向拓展而不是修改就是开闭原则是满足的。其实我们在项目中主要使用的是简单工厂而不是这个，因为这个的类文件剧增。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">public interface CarFactory &#123;</span><br><span class="line">    public Car createFactory();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public class BenChiFactory implements CarFactory &#123;</span><br><span class="line">    @Override</span><br><span class="line">    public Car createFactory() &#123;</span><br><span class="line">        return new Daben();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public class AudiFactory implements CarFactory &#123;</span><br><span class="line">    @Override</span><br><span class="line">    public Car createFactory() &#123;</span><br><span class="line">        return new Audi();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-抽象工厂"><a href="#3-抽象工厂" class="headerlink" title="3.抽象工厂"></a>3.抽象工厂</h3><p>抽象工厂其实和上面的两个方式区别很大，主要是因为上面两个的维度是创建产品而这个地方的维度是创建一个产品组。也就是比如我们有一个车的工厂，其实这个工厂是创建很多车的零部件而不是一个车，那么我们有多个车的工厂的目的就是为了创建不同层次的车零件。比如下面这个例子，就是他的维度是横向的一个维度。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; 座椅类型</span><br><span class="line">public interface Seat &#123;</span><br><span class="line">    public void desc();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class LuxurySeat implements Seat &#123;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void desc() &#123;</span><br><span class="line">        System.out.println(&quot;high quality seat&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class LowSeat implements Seat &#123;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void desc() &#123;</span><br><span class="line">        System.out.println(&quot;low seat&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 引擎类型</span><br><span class="line">public interface Engine &#123;</span><br><span class="line">    public void run();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class LuxuryEngine implements Engine &#123;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void run() &#123;</span><br><span class="line">        System.out.println(&quot;high speed engine&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class LowEngine implements Engine &#123;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void run() &#123;</span><br><span class="line">        System.out.println(&quot;low engine&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 车的抽象工厂</span><br><span class="line">public interface AbstractCarFactory &#123;</span><br><span class="line">    public Seat createSeat();</span><br><span class="line">    public Engine creaateEngine();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 两个工厂的实现，分别是高级车工厂，低级车工厂</span><br><span class="line">public class LuxuryCarFactory implements AbstractCarFactory &#123;</span><br><span class="line">    @Override</span><br><span class="line">    public Seat createSeat() &#123;</span><br><span class="line">        return new LuxurySeat();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public Engine creaateEngine() &#123;</span><br><span class="line">        return new LuxuryEngine();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public class LowCarFactory implements AbstractCarFactory&#123;</span><br><span class="line">    @Override</span><br><span class="line">    public Seat createSeat() &#123;</span><br><span class="line">        return new LowSeat();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public Engine creaateEngine() &#123;</span><br><span class="line">        return new LowEngine();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="三、建造者模式"><a href="#三、建造者模式" class="headerlink" title="三、建造者模式"></a>三、建造者模式</h2><p>建造者模式分为两部分，第一个部分其实就是工厂模式创建对象，然后另外一部分就是组装创建整个大对象。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; 创建工厂</span><br><span class="line">public interface BuilderFactory &#123;</span><br><span class="line">    Engine createEngine();</span><br><span class="line">    Seat createSeat();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public class AirShipBuilderFactory implements BuilderFactory &#123;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public Engine createEngine() &#123;</span><br><span class="line">        return new Engine() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public void run() &#123;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public Seat createSeat() &#123;</span><br><span class="line">        return new Seat() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public void desc() &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F; 组装工厂</span><br><span class="line">public class AirDirectFactory &#123;</span><br><span class="line"></span><br><span class="line">    private BuilderFactory builderFactory;</span><br><span class="line"></span><br><span class="line">    public AirShip buildAirShip() &#123;</span><br><span class="line">        Engine engine &#x3D; builderFactory.createEngine();</span><br><span class="line">        Seat seat &#x3D; builderFactory.createSeat();</span><br><span class="line">        return new AirShip(engine, seat);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public AirDirectFactory(BuilderFactory builderFactory) &#123;</span><br><span class="line">        this.builderFactory &#x3D; builderFactory;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="四、原型模式"><a href="#四、原型模式" class="headerlink" title="四、原型模式"></a>四、原型模式</h2><p>可以称之为克隆或者拷贝，然后在拷贝的对象上修改就可以产生新对象，其实js 的原型就是这么干的。</p>
<p>这里需要注意一下这里的一个深拷贝的问题，如果没有作深拷贝而是直接的做了一个 super 的调用可能导致状态关联问题。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">@NoArgsConstructor</span><br><span class="line">@AllArgsConstructor</span><br><span class="line">@Builder(toBuilder &#x3D; true)</span><br><span class="line">@Data</span><br><span class="line">@Accessors(chain &#x3D; true,fluent &#x3D; true)</span><br><span class="line">public class Sheep implements Cloneable&#123;</span><br><span class="line">    private String name;</span><br><span class="line">    private Date birthday;</span><br><span class="line"></span><br><span class="line">    &#x2F;**</span><br><span class="line">     * 注意在克隆的时候需要进行深拷贝负责就会出现错误结果</span><br><span class="line">     * @return</span><br><span class="line">     * @throws CloneNotSupportedException</span><br><span class="line">     *&#x2F;</span><br><span class="line">    @Override</span><br><span class="line">    protected Object clone() throws CloneNotSupportedException &#123;</span><br><span class="line"></span><br><span class="line">        Sheep clone &#x3D; (Sheep) super.clone();</span><br><span class="line">        clone.birthday &#x3D; (Date) this.birthday.clone();</span><br><span class="line">        return clone;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public class PrototypeClient &#123;</span><br><span class="line">    public static void main(String[] args) throws CloneNotSupportedException &#123;</span><br><span class="line">        Sheep sheep1 &#x3D; new Sheep(&quot;A&quot;, new Date());</span><br><span class="line">        Sheep sheep2 &#x3D; (Sheep) sheep1.clone();</span><br><span class="line">        sheep2.birthday(new Date()).name(&quot;sss&quot;);</span><br><span class="line">        System.out.println(sheep2);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>另外我们除了使用上面的克隆方法我们还可以使用序列化的方式直接生成一个一模一样的对象出来。具体来说就是我们可以用输入输出流来生成对象</strong></p>
<h2 id="五、适配器模式"><a href="#五、适配器模式" class="headerlink" title="五、适配器模式"></a>五、适配器模式</h2><p>将一个接口转化成另外一个接口，从而使两个原来不能一起工作的组件一起工作。</p>
<p>我们可以想像一下一个 usb 转 hdmi ，那么就有一个目标方和一个被适配方。也就是两个接口再有一个适配器就完成了。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; 目标方的接口</span><br><span class="line">public interface Target &#123;</span><br><span class="line">    void use();</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F; 被适配方 其实最好是一个接口这里直接写成了一个类</span><br><span class="line">public class BeAdapter &#123;</span><br><span class="line">    public void hello()&#123;</span><br><span class="line">        System.out.println(&quot;say hello&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 适配器 实现了目标方，组合了被适配方</span><br><span class="line">@Data</span><br><span class="line">@AllArgsConstructor</span><br><span class="line">public class AdapterDemo implements Target &#123;</span><br><span class="line">    &#x2F;&#x2F; 其实这里可以进一步抽象 也就是所有的被适配对象另起一个接口即可</span><br><span class="line">    BeAdapter beAdapter;</span><br><span class="line"></span><br><span class="line">    public void use() &#123;</span><br><span class="line">        beAdapter.hello();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public class AdapterClient &#123;</span><br><span class="line">    public static void test(Target target)&#123;</span><br><span class="line">        target.use();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        AdapterDemo adapterDemo &#x3D; new AdapterDemo(new BeAdapter());</span><br><span class="line">        test(adapterDemo);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="六、代理模式"><a href="#六、代理模式" class="headerlink" title="六、代理模式"></a>六、代理模式</h2><h3 id="1-静态代理"><a href="#1-静态代理" class="headerlink" title="1.静态代理"></a>1.静态代理</h3><p>这种代理模式就是在代理对象上保留一个被代理对象的指针，然后有些事情直接调用被代理对象的方法完成，并且可以做一些前置或者后置的操作。</p>
<h3 id="2-动态代理"><a href="#2-动态代理" class="headerlink" title="2.动态代理"></a>2.动态代理</h3><h4 id="1-JDK-代理"><a href="#1-JDK-代理" class="headerlink" title="1.JDK 代理"></a>1.JDK 代理</h4><p>其实关键部分就两个：第一个就是一个处理器，所有的对代理的请求的方法都走到了处理器。另外一个就是生成代理对象过程。</p>
<p>处理器</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">@AllArgsConstructor</span><br><span class="line">public class SimpleHandler implements InvocationHandler &#123;</span><br><span class="line">    RealObject real;</span><br><span class="line">    public Object invoke(Object proxy, Method method, Object[] args) throws Throwable &#123;</span><br><span class="line">        System.out.println(&quot;heihei&quot;);</span><br><span class="line">        return (Object) method.invoke(real, args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>被代理对象</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">public interface ObjectInterface &#123;</span><br><span class="line">    public void hello();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public class RealObject implements ObjectInterface &#123;</span><br><span class="line">    public void hello()&#123;</span><br><span class="line">        System.out.println(&quot;hello&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>生成代理对象的过程</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">public class JdkClient &#123;</span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        RealObject realObject &#x3D; new RealObject();</span><br><span class="line">        SimpleHandler simpleHandler &#x3D; new SimpleHandler(realObject);</span><br><span class="line">        ObjectInterface proxyInstance &#x3D; (ObjectInterface) Proxy.newProxyInstance(ClassLoader.getSystemClassLoader(), new Class[]&#123;ObjectInterface.class&#125;, simpleHandler);</span><br><span class="line">        proxyInstance.hello();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="七、桥接模式"><a href="#七、桥接模式" class="headerlink" title="七、桥接模式"></a>七、桥接模式</h2><p>桥接模式就是为了处理两个维度的事情，比如说我们定义一个电脑类，那么我们如果需要售卖笔记本、平板、台式机而这些东西又有不同的品牌那么我们就需要建立很多的类在电脑这个类下面。但是我们采用桥接的话我们抽出一个接口这个接口代表了品牌，然后有一个抽象类（电脑类型）包含了品牌的引用，我们只需要在不同的电脑类型下面建立各个类型，在创建一个品牌类型的电脑的时候直接 new 出来就行了。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; 品牌</span><br><span class="line">public interface Brand &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">class Dell implements Brand &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">class Levon implements Brand &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 电脑的类型</span><br><span class="line">@AllArgsConstructor</span><br><span class="line">public abstract class AbstractComputer &#123;</span><br><span class="line">    private Brand brand;</span><br><span class="line">    public void sell()&#123;</span><br><span class="line">        System.out.println(&quot;sell...&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class DesktopComp extends AbstractComputer &#123;</span><br><span class="line">    public DesktopComp(Brand brand) &#123;</span><br><span class="line">        super(brand);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class PadComp extends AbstractComputer &#123;</span><br><span class="line">    public PadComp(Brand brand) &#123;</span><br><span class="line">        super(brand);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F;使用</span><br><span class="line">public class BridgeClient &#123;</span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        DesktopComp levonDesktopComp &#x3D; new DesktopComp(new Levon());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="八、策略模式"><a href="#八、策略模式" class="headerlink" title="八、策略模式"></a>八、策略模式</h2><p>策略模式就是将一个方法传入到一个地方，简单点来说就是传入一个回调方法，真实是使用的时候看我们传递进去的那个方法作用。</p>
<h2 id="九、模板设计模式"><a href="#九、模板设计模式" class="headerlink" title="九、模板设计模式"></a>九、模板设计模式</h2><p>在上层的抽象类中放一些抽象方法先调用上，子类在继承的时候实现这些类就行了。</p>
<h2 id="10、观察者模式"><a href="#10、观察者模式" class="headerlink" title="10、观察者模式"></a>10、观察者模式</h2><p>在对一些变量修改或者方法调用的时候胡触发观察者的方法调用或者状态的转变，其实就相当于埋点。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2018/08/06/Java%20SE/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" data-id="cmblmb67a004wl6ofa7zz46ff" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java/" rel="tag">Java</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Java Web/Lombok常用功能" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/08/05/Java%20Web/Lombok%E5%B8%B8%E7%94%A8%E5%8A%9F%E8%83%BD/" class="article-date">
  <time datetime="2018-08-05T21:23:43.000Z" itemprop="datePublished">2018-08-05</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/08/05/Java%20Web/Lombok%E5%B8%B8%E7%94%A8%E5%8A%9F%E8%83%BD/">Lombok 常用功能</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Lombok-常用功能"><a href="#Lombok-常用功能" class="headerlink" title="Lombok 常用功能"></a>Lombok 常用功能</h1><h2 id="1-导入"><a href="#1-导入" class="headerlink" title="1.导入"></a>1.导入</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.projectlombok&lt;&#x2F;groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;lombok&lt;&#x2F;artifactId&gt;</span><br><span class="line">    &lt;version&gt;1.16.20&lt;&#x2F;version&gt;</span><br><span class="line">    &lt;scope&gt;provided&lt;&#x2F;scope&gt;</span><br><span class="line">&lt;&#x2F;dependency&gt;</span><br></pre></td></tr></table></figure>

<h2 id="2-Getter-Setter"><a href="#2-Getter-Setter" class="headerlink" title="2.@Getter/@Setter"></a>2.@Getter/@Setter</h2><p>这两个注解可以在类上也可以在字段上，看需要的粒度而定。</p>
<h2 id="3-ToString"><a href="#3-ToString" class="headerlink" title="3.@ToString"></a>3.@ToString</h2><p>生成一个 json 类型的字符串</p>
<h2 id="4-EqualsAndHashCode"><a href="#4-EqualsAndHashCode" class="headerlink" title="4.@EqualsAndHashCode"></a>4.@EqualsAndHashCode</h2><p>生成 equals 和 hashcode</p>
<h2 id="5-NoArgsConstructor"><a href="#5-NoArgsConstructor" class="headerlink" title="5.@NoArgsConstructor"></a>5.@NoArgsConstructor</h2><p>生成午无参构造器</p>
<h2 id="6-RequiredArgsConstructor"><a href="#6-RequiredArgsConstructor" class="headerlink" title="6.@RequiredArgsConstructor"></a>6.@RequiredArgsConstructor</h2><p>只对标有 @NonNull 的字段生成构造器，并且初始化的时候会检查NonNull 的字段如果为空则抛出异常。</p>
<h2 id="7-AllArgsConstructor"><a href="#7-AllArgsConstructor" class="headerlink" title="7.@AllArgsConstructor"></a>7.@AllArgsConstructor</h2><p>所有字段的构造器</p>
<h2 id="8-Data"><a href="#8-Data" class="headerlink" title="8.@Data"></a>8.@Data</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@Data&#96;是一个集合体。包含&#96;Getter&#96;,&#96;Setter&#96;,&#96;RequiredArgsConstructor&#96;,&#96;ToString&#96;,&#96;EqualsAndHashCode</span><br></pre></td></tr></table></figure>

<h2 id="9-Value"><a href="#9-Value" class="headerlink" title="9.@Value"></a>9.@Value</h2><p>可以帮忙生成一个不可变对象。对于所有的字段都将生成final的。同<code>@Data</code>， <code>@Value</code>是一个集合体。包含<code>Getter</code>,<code>AllArgsConstructor</code>,<code>ToString</code>,<code>EqualsAndHashCode</code>。</p>
<h2 id="10-Builder"><a href="#10-Builder" class="headerlink" title="10.@Builder"></a>10.@Builder</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Room room &#x3D; builder().name(&quot;name&quot;).id(&quot;id&quot;).createTime(new Date()).occupation(&quot;1&quot;).occupation(&quot;2&quot;).build();</span><br></pre></td></tr></table></figure>

<h2 id="11-Log"><a href="#11-Log" class="headerlink" title="11.@Log"></a>11.@Log</h2><p>一个日志属性，可以直接使用的。</p>
<h2 id="12-UtilityClass"><a href="#12-UtilityClass" class="headerlink" title="12.@UtilityClass"></a>12.@UtilityClass</h2><p>工具类</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">@UtilityClass</span><br><span class="line">public class Utility &#123;</span><br><span class="line"></span><br><span class="line">    public String getName() &#123;</span><br><span class="line">        return &quot;name&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public static void main(String[] args) &#123;</span><br><span class="line">    &#x2F;&#x2F; Utility utility &#x3D; new Utility(); 构造函数为私有的,</span><br><span class="line">    System.out.println(Utility.getName());</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="13-Cleanup"><a href="#13-Cleanup" class="headerlink" title="13.@Cleanup"></a>13.@Cleanup</h2><p>用于流等可以不需要关闭使用流对象.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">@Cleanup</span><br><span class="line">OutputStream outStream &#x3D; new FileOutputStream(new File(&quot;text.txt&quot;));</span><br><span class="line">@Cleanup</span><br><span class="line">InputStream inStream &#x3D; new FileInputStream(new File(&quot;text2.txt&quot;));</span><br><span class="line">byte[] b &#x3D; new byte[65536];</span><br><span class="line">while (true) &#123;</span><br><span class="line">   int r &#x3D; inStream.read(b);</span><br><span class="line">   if (r &#x3D;&#x3D; -1) break;</span><br><span class="line">   outStream.write(b, 0, r); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2018/08/05/Java%20Web/Lombok%E5%B8%B8%E7%94%A8%E5%8A%9F%E8%83%BD/" data-id="cmblmb67u006pl6of1l37cre8" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java%E5%B7%A5%E5%85%B7/" rel="tag">Java工具</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-JVM/Java Class对象和反射" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/08/04/JVM/Java%20Class%E5%AF%B9%E8%B1%A1%E5%92%8C%E5%8F%8D%E5%B0%84/" class="article-date">
  <time datetime="2018-08-04T21:38:50.000Z" itemprop="datePublished">2018-08-04</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Java-%E8%99%9A%E6%8B%9F%E6%9C%BA/">-Java -虚拟机</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/08/04/JVM/Java%20Class%E5%AF%B9%E8%B1%A1%E5%92%8C%E5%8F%8D%E5%B0%84/">Java Class对象与反射机制</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Java-Class对象与反射机制"><a href="#Java-Class对象与反射机制" class="headerlink" title="Java Class对象与反射机制"></a>Java Class对象与反射机制</h1><h2 id="一、关于Class对象"><a href="#一、关于Class对象" class="headerlink" title="一、关于Class对象"></a>一、关于Class对象</h2><h3 id="1-基本介绍"><a href="#1-基本介绍" class="headerlink" title="1.基本介绍"></a>1.基本介绍</h3><p>其实我们在任何一个 Java 应用程序中都会存在 class 对象，这个 class 对象其实就是每一个类、类型、数组、接口 等等被加载的时候在 jvm 中创建的。也就是这些类型的一个映射，这些类型在虚拟机中的实体。正是由于存在这个对象在 Jvm 中我们可以通过一定的方式获取这个对象然后去用这个对象去对我们的各种类型做一些加载获取属性等等操作，当然主要是对类进行操作并能够执行他的方法，探知未知的类的各种信息。</p>
<h3 id="2-官方文档解释"><a href="#2-官方文档解释" class="headerlink" title="2.官方文档解释"></a>2.官方文档解释</h3><p>这是我摘录的 Class 类的 javadoc 内容：</p>
<blockquote>
<ol>
<li>Instances of the class Class represent classes and interfaces in a running Java application.</li>
<li>An enum is a kind of class and an annotation is a kind of interface.</li>
<li>Every array also belongs to a class that is reflected as a Class object that is shared by all arrays with the same element type and number of dimensions.</li>
<li>The primitive Java types (boolean, byte, char, short, int, long, float, and double), and the keyword void are also represented as Class objects.</li>
<li>Class has no public constructor.Instead Class objects are constructed automatically by the Java Virtual Machine as classes are loaded and by calls to the defineClass method in the class loader.</li>
</ol>
</blockquote>
<p>其实里面主要说了这么几件事：</p>
<h4 id="1-class-对象代表类和接口"><a href="#1-class-对象代表类和接口" class="headerlink" title="1.class 对象代表类和接口"></a>1.class 对象代表类和接口</h4><p>这个比较好理解其实我们可以看一个例子就能明白：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Class clazz &#x3D; Long.class;</span><br></pre></td></tr></table></figure>

<p>前面是 Class 类型后面就是一个具体的变量，那么为什么我们没有 new 这个对象就能获取到呢？ 其实在这里我们使用了 Long 这个类，那么这个类就会被 jvm 加载之后在 jvm 中形成了他所对应的 class 对象，我们在赋值的时候直接从 jvm 取到即可，这里我们也比较好理解这个类的对象其实在内存中只有一份，也就是单例的，这是因为没必要存在多份，他只是一个类的一个内存映射。</p>
<h4 id="2-枚举是类注解是接口"><a href="#2-枚举是类注解是接口" class="headerlink" title="2.枚举是类注解是接口"></a>2.枚举是类注解是接口</h4><p>注解是接口是头一回听说，但是他的定义方式比较能说明问题，应该是在编译期做了转换吧。</p>
<h4 id="3-同维同类型数组class-对象相同"><a href="#3-同维同类型数组class-对象相同" class="headerlink" title="3.同维同类型数组class 对象相同"></a>3.同维同类型数组class 对象相同</h4><p>这个也就是说他们的类型和维数一致才可以，具体看一个例子：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">int[] arr1&#x3D;new int[1];</span><br><span class="line">int[] arr2&#x3D;new int[2];</span><br><span class="line">Assert.check(arr1.getClass()&#x3D;&#x3D;arr2.getClass());</span><br></pre></td></tr></table></figure>

<h4 id="4-基本类型也有-class-对象"><a href="#4-基本类型也有-class-对象" class="headerlink" title="4.基本类型也有 class 对象"></a>4.基本类型也有 class 对象</h4><h4 id="5-class-对象不用创建"><a href="#5-class-对象不用创建" class="headerlink" title="5.class 对象不用创建"></a>5.class 对象不用创建</h4><p>class 对象是没有公共的构造方法，也没有静态的 getInsteance() 所以说没办法从外部构造方法，是直接的由 jvm 在加载类的时候调用了类加载的 defineClass() 方法完成 class 对象的创建的。</p>
<h3 id="3-class-对象获取"><a href="#3-class-对象获取" class="headerlink" title="3.class 对象获取"></a>3.class 对象获取</h3><p>对于 class 对象的获取方式有三种：</p>
<ol>
<li><p>使用类型属性</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Class clazz &#x3D; Long.class</span><br></pre></td></tr></table></figure>
</li>
<li><p>调用对象的 getClass() 方法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">List list &#x3D; new ArrayList();</span><br><span class="line">Class clazz &#x3D; list.getClass();</span><br></pre></td></tr></table></figure>
</li>
<li><p>使用forName()静态方法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">try &#123;</span><br><span class="line">    Class.forName(&quot;com.apple.concurrent.Dispatch&quot;);</span><br><span class="line">&#125; catch (ClassNotFoundException e) &#123;</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h2 id="二、关于反射"><a href="#二、关于反射" class="headerlink" title="二、关于反射"></a>二、关于反射</h2><p>先写一个简单的 javaBean 然后对这个 bean 就进行一些操作：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> grammer;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">User</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">User</span><span class="params">(String name, <span class="keyword">int</span> age)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAge</span><span class="params">(<span class="keyword">int</span> age)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getAge</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> age;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>然后我们主要讨论关于对于属性、方法、构造器的获取以及使用。</p>
<h4 id="1-通过-class-对象创建对象"><a href="#1-通过-class-对象创建对象" class="headerlink" title="1.通过 class 对象创建对象"></a>1.通过 class 对象创建对象</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Class&lt;User&gt; userClass = User.class;</span><br><span class="line">User userInstance = userClass.newInstance();</span><br></pre></td></tr></table></figure>

<h4 id="2-获取所有的构造方法"><a href="#2-获取所有的构造方法" class="headerlink" title="2. 获取所有的构造方法"></a>2. 获取所有的构造方法</h4><p>注意以下两个都是获取构造器列表，但是前面的是可以获取到私有的构造器，而后者并不可以，其他的都是同理的对于方法和字段来说</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Constructor&lt;?&gt;[] constructors = userClass.getDeclaredConstructors();</span><br><span class="line">Constructor&lt;?&gt;[] constructors1 = userClass.getConstructors();</span><br></pre></td></tr></table></figure>

<h4 id="3-获取所有的属性"><a href="#3-获取所有的属性" class="headerlink" title="3. 获取所有的属性"></a>3. 获取所有的属性</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Field[] fields = userClass.getDeclaredFields();</span><br></pre></td></tr></table></figure>

<h4 id="4-获取所有的方法"><a href="#4-获取所有的方法" class="headerlink" title="4.获取所有的方法"></a>4.获取所有的方法</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Method[] methods = userClass.getDeclaredMethods();</span><br></pre></td></tr></table></figure>

<h4 id="5-获取某个私有属性"><a href="#5-获取某个私有属性" class="headerlink" title="5.获取某个私有属性"></a>5.获取某个私有属性</h4><p>这个要注意对于私有属性，只有用 <code>fieldName.setAccessible(true);</code> 设置访问权限后 jvm 再运行的时候不会做权限验证 也就不会报错了</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Field fieldName = userClass.getDeclaredField(<span class="string">&quot;name&quot;</span>);</span><br><span class="line">fieldName.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">System.out.println(fieldName.getName());</span><br><span class="line"><span class="comment">// 设置值需要调用那个对应的对象  需要指明对象才可以</span></span><br><span class="line">fieldName.set(userInstance,<span class="string">&quot;lwen&quot;</span>);</span><br></pre></td></tr></table></figure>

<h4 id="6-获取某个方法并调用"><a href="#6-获取某个方法并调用" class="headerlink" title="6.获取某个方法并调用"></a>6.获取某个方法并调用</h4><p>这个地方需要指明我们调用的参数的具体类型，否则会由于我们的 java 重载机制而出现模糊不清的情况。当然如果是私有方法我们在调用之前必须要指定他们的访问权限，否则也会调用失败，对于构造方法也是这样的。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Method setNameMethod = userClass.getDeclaredMethod(<span class="string">&quot;setName&quot;</span>, String.class);</span><br><span class="line"><span class="comment">//调用方法也是需要指明对象</span></span><br><span class="line">setNameMethod.invoke(userInstance,<span class="string">&quot;lwen&quot;</span>);</span><br></pre></td></tr></table></figure>

<h4 id="7-反射性能问题"><a href="#7-反射性能问题" class="headerlink" title="7.反射性能问题"></a>7.反射性能问题</h4><p>反射的性能一般比普通调用的性能要低很多，一般一个方法的执行时间应该是 30 倍的关系，我们希望能够加快反射的速度可以使用跳过安全检查 setAccessible(true) 来提升效率，一般相对使用反射来说的话是提升 4 倍效率。另外我们为了操作 class 我们还可以使用一些第三方的操作字节码的类库比如操作底层字节码的 ASM ，以及基于代码的 javassist 和 GCLIB 等等。</p>
<p>这里说一下关于 javassist 的使用，如何使用它来生成一个 class 文件。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> grammer;</span><br><span class="line"><span class="keyword">import</span> javassist.*;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JavassistDemo</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> CannotCompileException, NotFoundException, IOException </span>&#123;</span><br><span class="line">        ClassPool pool = ClassPool.getDefault();</span><br><span class="line">        CtClass ctClass = pool.makeClass(<span class="string">&quot;out.Empl&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//    创建属性</span></span><br><span class="line">        CtField int_age = CtField.make(<span class="string">&quot;private int age;&quot;</span>, ctClass);</span><br><span class="line">        ctClass.addField(int_age);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//    创建方法</span></span><br><span class="line">        CtMethod method = (CtMethod) CtMethod.make(<span class="string">&quot;public int getAge()&#123;return this.age;&#125;&quot;</span>, ctClass);</span><br><span class="line">        ctClass.addMethod(method);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//  创建构造器</span></span><br><span class="line">        CtConstructor constructor = <span class="keyword">new</span> CtConstructor(<span class="keyword">new</span> CtClass[]&#123;CtClass.intType&#125;, ctClass);</span><br><span class="line">        constructor.setBody(<span class="string">&quot;&#123;this.age=age;&#125;&quot;</span>);</span><br><span class="line">        ctClass.addConstructor(constructor);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//    生成</span></span><br><span class="line">        ctClass.writeFile();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2018/08/04/JVM/Java%20Class%E5%AF%B9%E8%B1%A1%E5%92%8C%E5%8F%8D%E5%B0%84/" data-id="cmblmb66s003il6ofb1977awn" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java-%E8%99%9A%E6%8B%9F%E6%9C%BA/" rel="tag">Java 虚拟机</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-DataBase/MyBatis笔记六：整合Spring" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/06/06/DataBase/MyBatis%E7%AC%94%E8%AE%B0%E5%85%AD%EF%BC%9A%E6%95%B4%E5%90%88Spring/" class="article-date">
  <time datetime="2018-06-06T22:01:49.000Z" itemprop="datePublished">2018-06-06</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/MyBatis/">MyBatis</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/06/06/DataBase/MyBatis%E7%AC%94%E8%AE%B0%E5%85%AD%EF%BC%9A%E6%95%B4%E5%90%88Spring/">MyBatis笔记六：整合Spring</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="MyBatis笔记六：整合Spring"><a href="#MyBatis笔记六：整合Spring" class="headerlink" title="MyBatis笔记六：整合Spring"></a>MyBatis笔记六：整合Spring</h1>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2018/06/06/DataBase/MyBatis%E7%AC%94%E8%AE%B0%E5%85%AD%EF%BC%9A%E6%95%B4%E5%90%88Spring/" data-id="cmblmb66e0022l6offocjf1c8" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java/" rel="tag">Java</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MyBatis/" rel="tag">MyBatis</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" rel="tag">数据库</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-DataBase/MyBatis笔记五：缓存" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/06/05/DataBase/MyBatis%E7%AC%94%E8%AE%B0%E4%BA%94%EF%BC%9A%E7%BC%93%E5%AD%98/" class="article-date">
  <time datetime="2018-06-05T18:01:49.000Z" itemprop="datePublished">2018-06-05</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/MyBatis/">MyBatis</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/06/05/DataBase/MyBatis%E7%AC%94%E8%AE%B0%E4%BA%94%EF%BC%9A%E7%BC%93%E5%AD%98/">MyBatis笔记五：缓存</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="MyBatis笔记五：缓存"><a href="#MyBatis笔记五：缓存" class="headerlink" title="MyBatis笔记五：缓存"></a>MyBatis笔记五：缓存</h1><p>Mybatis 的缓存是分为两级缓存的，一个是本地缓存，也就是默认的缓存，这一个缓存是默认开启的。这个缓存是 sqlSession 级别的缓存也就是一个数据库会话的缓存，这个缓存其实说白了就是 sqlSession 级别的一个 Map 。</p>
<h2 id="1-一级缓存"><a href="#1-一级缓存" class="headerlink" title="1.一级缓存"></a>1.一级缓存</h2><p>一级缓存底层是一个 map 。虽然缓存默认开启的但是我们也会遇到缓存失效的情况：</p>
<ul>
<li>sqlSession 不同</li>
<li>查询条件不同，导致返回的数据都不同</li>
<li>在两次查询之间进行了插删改操作</li>
<li>手动使用了 <code>sqlSession.clearCache</code> 方法清除了缓存。</li>
</ul>
<h2 id="2-二级缓存"><a href="#2-二级缓存" class="headerlink" title="2.二级缓存"></a>2.二级缓存</h2><p> 二级缓存是在一级缓存的基础之上的，因为我们的一级缓存是在会话关闭之后这个缓存数据就失效了，那么我们的二级缓存的做的事情就是在会话关闭的时候我们的一级缓存的数据会被转移到一级缓存中，然后新的会话就可以参照二级缓存中的数据。</p>
<p>二级缓存是基于 namespace 的缓存，也就是每一个mapper就是一个二级缓存的空间，他们之间是互相不干扰的。不同的 namespace 查出的数据放到自己的缓存中，也就是 map 中。</p>
<h3 id="1-开启二级缓存"><a href="#1-开启二级缓存" class="headerlink" title="1.开启二级缓存"></a>1.开启二级缓存</h3><p>默认的情况是开启的，我们也应该显示的配置，就是在settings标签中配置。</p>
<h3 id="2-使用缓存"><a href="#2-使用缓存" class="headerlink" title="2.使用缓存"></a>2.使用缓存</h3><p>在 mapper 的 xml 中，使用cache标签，配置当前的 namespace 的缓存策略。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">cache</span> <span class="attr">eviction</span>=<span class="string">&quot;FIFO&quot;</span> <span class="attr">flushInterval</span>=<span class="string">&quot;60000&quot;</span> <span class="attr">readOnly</span>=<span class="string">&quot;true&quot;</span> <span class="attr">size</span>=<span class="string">&quot;12&quot;</span> <span class="attr">type</span>=<span class="string">&quot;&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>eviction：缓存的回收策略：</p>
<ul>
<li>LRU - 最近最少使用的：移除最长时间不被使用的对象。</li>
<li>FIFO -先进先出：按对象进入缓存的顺序来移除它们。</li>
<li>SOFT - 软引用：移除基于垃圾回收器状态和软引用规则的对象。</li>
<li>WEAK - 弱引用：更积极地移除基于垃圾收集器状态和弱引用规则的对象。</li>
<li>默认的是LRU.</li>
</ul>
</li>
<li><p>flushInterval：缓存刷新间隔。缓存多长时间清空一次，默认不清空，设置一个毫秒值</p>
</li>
<li><p>readonly：是否只读：</p>
<ul>
<li><p>true：只读； mybatis认为所有从缓存中获取数据的操作都是只读操作，不会修改数据。</p>
<p>mybatis为了加快获取速度，直接就会将数据在缓存中的引用交给用户。不安全，速度快</p>
</li>
<li><p>false：非只读： mybatis觉得获取的数据可能会被修改。mybatis会利用序列化&amp;反序列的技术克隆一份新的数据给你。 安全，速度慢</p>
</li>
</ul>
</li>
<li><p>size：缓存存放多少元素；</p>
</li>
<li><p>type=”” 指定自定义缓存的全类名，但是这个类要实现Cache接口即可；</p>
</li>
</ul>
<p><strong>当然如果我们什么东西都不写的话，也就是只写了一个cache标签，他么上述的属性会自动的被应用。</strong></p>
<p><strong>然后就是我们的Cache的自定义，其实Cache的自定义比较简单也就是我们直接实现它的Cache 接口然后实现一些东西就好，但是更好的就是我们其实不用自己写这些东西，在Mybatis的Github上有很多已经写好的cache适配包不用我们自己写、然后再缓存标签中表明type为我们的适配包的类就好了。</strong></p>
<h3 id="3-POJO实现序列化接口"><a href="#3-POJO实现序列化接口" class="headerlink" title="3.POJO实现序列化接口"></a>3.POJO实现序列化接口</h3><p>我们的每一个POJO都需要实现序列化接口，否则就会报错，因为我们如果没有开启 readonly 的话我们就必须采用序列化的方式来获取缓存下来的POJO对象。</p>
<h3 id="4-注意"><a href="#4-注意" class="headerlink" title="4.注意"></a>4.注意</h3><p>只有当我们的 sqlSession 关闭以后我们的一级缓存内容才会放到二级缓存中去，否则一直是一级缓存在起作用的。</p>
<ol>
<li>cacheEnabled=true: false：关闭缓存(二级缓存关闭) (一级缓存一直可用）</li>
<li>每个select标签都有useCache=”true”. 如果为false：不使用缓存(一级缓存依然使用，二级缓存不使用)</li>
<li>每个增删改标签的： flushCache=”true”: 增册改执行完成后就会清除缓存。他是清除一级二级缓存。</li>
<li>sqlSession. clearCache( )；只是清除当前session的一级缓存，因为我们都是用的 sqlSession 的方法，自然清除的一级缓存。</li>
<li>localCacheScope：本地缓存作用域：(默认的一级缓存是SESSION) ；如果当前会话缓存为 STATEMENT：可以禁用一级缓存。】、</li>
</ol>
<h2 id="3-缓存原理"><a href="#3-缓存原理" class="headerlink" title="3.缓存原理"></a>3.缓存原理</h2><p><img src="https://user-images.githubusercontent.com/22151420/41044719-765d61fc-69d9-11e8-9448-2f0badc1d6e7.png" alt="image"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2018/06/05/DataBase/MyBatis%E7%AC%94%E8%AE%B0%E4%BA%94%EF%BC%9A%E7%BC%93%E5%AD%98/" data-id="cmblmb66d0020l6of9ky1b3i0" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java/" rel="tag">Java</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MyBatis/" rel="tag">MyBatis</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" rel="tag">数据库</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-DataBase/MyBatis笔记四：动态SQL" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/06/02/DataBase/MyBatis%E7%AC%94%E8%AE%B0%E5%9B%9B%EF%BC%9A%E5%8A%A8%E6%80%81SQL/" class="article-date">
  <time datetime="2018-06-02T22:01:49.000Z" itemprop="datePublished">2018-06-02</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/MyBatis/">MyBatis</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/06/02/DataBase/MyBatis%E7%AC%94%E8%AE%B0%E5%9B%9B%EF%BC%9A%E5%8A%A8%E6%80%81SQL/">MyBatis笔记四：动态SQL</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="MyBatis笔记四：动态SQL"><a href="#MyBatis笔记四：动态SQL" class="headerlink" title="MyBatis笔记四：动态SQL"></a>MyBatis笔记四：动态SQL</h1><p>什么是动态SQL？ 简单来说就是类似于OGNL 表达式的这种 SQL 标签的嵌套然后帮助我们生成SQL语句而避免另外我们的拼字符串的操作。</p>
<h3 id="1-if标签"><a href="#1-if标签" class="headerlink" title="1.if标签"></a>1.if标签</h3><p>if 标签中的 test 属性就是用来测试条件的，然后里面的条件之间可以采用 and or来连接，当然我们也可以使用 &amp;&amp; 这种，但是注意我们只能使用它们的实体符号而不能直接使用 &amp;&amp; 这种。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">DynamicSelectIf</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">    SqlSessionFactory sessionFactory = GettingStart.getSessionFactory(<span class="string">&quot;mybatis.xml&quot;</span>);</span><br><span class="line">    SqlSession sqlSession = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        sqlSession = sessionFactory.openSession(<span class="keyword">true</span>);</span><br><span class="line">        EmployeeDynamicMapper mapper = sqlSession.getMapper(EmployeeDynamicMapper.class);</span><br><span class="line">        Employee emp = mapper.getEmp(<span class="keyword">new</span> Employee(<span class="number">13</span>, <span class="string">&quot;lwen&quot;</span>, <span class="number">12</span>));</span><br><span class="line">        System.out.println(emp);</span><br><span class="line"></span><br><span class="line">    &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (sqlSession != <span class="keyword">null</span>) &#123;</span><br><span class="line">            sqlSession.close();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getEmp&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;lwen.entries.Employee&quot;</span>&gt;</span></span><br><span class="line">    select *</span><br><span class="line">    from employee where</span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;id!=null&quot;</span>&gt;</span></span><br><span class="line">        id=#&#123;id&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;name!=null&quot;</span>&gt;</span></span><br><span class="line">        and name=#&#123;name&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>但是注意的一点就是假如我们没有传入我们的 id 字段的话，我们的sql就会报错，因为拼接会出问题啊。那么出来的 sql 就会是：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> employee <span class="keyword">where</span> <span class="keyword">and</span> <span class="keyword">name</span>=<span class="comment">#&#123;name&#125;</span></span><br></pre></td></tr></table></figure>

<p>显然会报错！</p>
<p><strong>解决方案1：</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getEmp&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;lwen.entries.Employee&quot;</span>&gt;</span></span><br><span class="line">    select *</span><br><span class="line">    from employee where</span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;1=1&quot;</span>&gt;</span></span><br><span class="line">        1=1</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;id!=null&quot;</span>&gt;</span></span><br><span class="line">        and id=#&#123;id&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;name!=null&quot;</span>&gt;</span></span><br><span class="line">        and name=#&#123;name&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>解决方案2：</strong></p>
<h3 id="2-where标签"><a href="#2-where标签" class="headerlink" title="2.where标签"></a>2.where标签</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getEmpWhere&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;lwen.entries.Employee&quot;</span>&gt;</span></span><br><span class="line">    select *</span><br><span class="line">    from employee</span><br><span class="line">    <span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;id!=null&quot;</span>&gt;</span></span><br><span class="line">            id=#&#123;id&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;name!=null&quot;</span>&gt;</span></span><br><span class="line">            and name=#&#123;name&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>可以看到我们删除了 where 关键字而是加上了 where标签这样的话虽然我们不传 id 我们的 sql 也是拼装正常的，不会报错。注意的一点就是我们的 where 标签只能解决当我们的 条件前面多出来的 and 或者 or 而不能解决后面的 and 比如说我们的 sql写成了：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getEmpWhere&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;lwen.entries.Employee&quot;</span>&gt;</span></span><br><span class="line">    select *</span><br><span class="line">    from employee</span><br><span class="line">    <span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;id!=null&quot;</span>&gt;</span></span><br><span class="line">            id=#&#123;id&#125; and</span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;name!=null&quot;</span>&gt;</span></span><br><span class="line">            name=#&#123;name&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>如果不传 name 的话就会报错。</p>
<p>可以看到我们的sql 语句是这样的：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EmployeeDynamicMapper.getEmpWhere1 - &#x3D;&#x3D;&gt;  Preparing: select * from employee where id&#x3D;? and ; </span><br></pre></td></tr></table></figure>

<h3 id="3-trim标签"><a href="#3-trim标签" class="headerlink" title="3.trim标签"></a>3.trim标签</h3><p>trim标签就是可以给一个语句加上一个前缀一个后缀，删除某个前缀删除某个后缀。</p>
<ul>
<li>prefix：加前缀</li>
<li>prefixOverrides：删前缀</li>
<li>suffix：加后缀</li>
<li>suffixOverrides：删后缀</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getEmpWhere1&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;lwen.entries.Employee&quot;</span>&gt;</span></span><br><span class="line">    select *</span><br><span class="line">    from employee</span><br><span class="line">    <span class="tag">&lt;<span class="name">trim</span> <span class="attr">prefix</span>=<span class="string">&quot;where&quot;</span> <span class="attr">suffixOverrides</span>=<span class="string">&quot;and&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;id!=null&quot;</span>&gt;</span></span><br><span class="line">            id=#&#123;id&#125; and</span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;name!=null&quot;</span>&gt;</span></span><br><span class="line">            name=#&#123;name&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">trim</span>&gt;</span>;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>解决上述问题呢。</p>
<h3 id="4-choose标签"><a href="#4-choose标签" class="headerlink" title="4.choose标签"></a>4.choose标签</h3><p>这个标签的功能就类似于带有 break 的 switch-case 语句，就是只会进入一个分支。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getEmpWhere2&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;lwen.entries.Employee&quot;</span>&gt;</span></span><br><span class="line">    select *</span><br><span class="line">    from employee</span><br><span class="line">    <span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">choose</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">when</span> <span class="attr">test</span>=<span class="string">&quot;id!=null&quot;</span>&gt;</span></span><br><span class="line">                id=#&#123;id&#125;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">when</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">when</span> <span class="attr">test</span>=<span class="string">&quot;name!=null&quot;</span>&gt;</span></span><br><span class="line">                name like #&#123;name&#125;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">when</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">otherwise</span>&gt;</span></span><br><span class="line">                age=1</span><br><span class="line">            <span class="tag">&lt;/<span class="name">otherwise</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">choose</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>可以看到这里的功能说白了就是根据我们传入了哪个属性就用哪个属性查询，如果啥都没有的话就使用我们默认的就好。</p>
<h3 id="5-set标签"><a href="#5-set标签" class="headerlink" title="5.set标签"></a>5.set标签</h3><p>我们上面都是在讨论关于选择的 条件判断问题，但是如果我们希望是更新也是条件进行的呢？我们这里就有与 where 对应的标签来保证我们的逗号不会多出来。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">&quot;updateEmp&quot;</span>&gt;</span></span><br><span class="line">    update employee</span><br><span class="line">        <span class="tag">&lt;<span class="name">set</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;name!=null&quot;</span>&gt;</span></span><br><span class="line">                name=#&#123;name&#125;,</span><br><span class="line">            <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;age!=null&quot;</span>&gt;</span></span><br><span class="line">                age=#&#123;age&#125;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>同样的既然我们上面可以使用 trim 做一个通用的查询，那我们肯定可以使用 trim 做一个更通用的更新</strong></p>
<h3 id="6-foreach标签"><a href="#6-foreach标签" class="headerlink" title="6.foreach标签"></a>6.foreach标签</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getEmpIn&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;lwen.entries.Employee&quot;</span>&gt;</span></span><br><span class="line">    select *</span><br><span class="line">    from employee where id in</span><br><span class="line">    <span class="tag">&lt;<span class="name">foreach</span> <span class="attr">collection</span>=<span class="string">&quot;ids&quot;</span> <span class="attr">item</span>=<span class="string">&quot;id&quot;</span> <span class="attr">separator</span>=<span class="string">&quot;,&quot;</span> <span class="attr">open</span>=<span class="string">&quot;(&quot;</span> <span class="attr">close</span>=<span class="string">&quot;)&quot;</span> <span class="attr">index</span>=<span class="string">&quot;index&quot;</span>&gt;</span></span><br><span class="line">        #&#123;id&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>主要用于 in 这种枚举类型的。自然的我们也是<strong>可以批量保存的</strong> 就是采用这种方式，也就是  values 的位置数据很多。</p>
<h3 id="7-内置参数"><a href="#7-内置参数" class="headerlink" title="7.内置参数"></a>7.内置参数</h3><ul>
<li>_databaseId  这个表示的就是 databaseProvider 也就是我们配置的数据源厂商的名字了</li>
<li>_parameter   这个表示的就是我们的方法的入参，如果单个参数就是它本身，如果是一个对象什么的就是一个 map</li>
</ul>
<h3 id="8-变量声明，绑定"><a href="#8-变量声明，绑定" class="headerlink" title="8.变量声明，绑定"></a>8.变量声明，绑定</h3><p>我们的某一个参数过来的值我们没办法修改，或者说给他加一些修饰，修改。比如我们的某个like查询我们希望给传过来的东西加上 % 那么我们没办法直接在 sql 中添加，这时候我们就可以使用一个新变量，然后再新变量里修饰原来的变量。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bind</span> <span class="attr">name</span>=<span class="string">&quot;_new&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&#x27;%&#x27;+name&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="9-sql抽取"><a href="#9-sql抽取" class="headerlink" title="9.sql抽取"></a>9.sql抽取</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">sql</span> <span class="attr">id</span>=<span class="string">&quot;select&quot;</span>&gt;</span></span><br><span class="line">    select name,id,$&#123;other&#125;</span><br><span class="line">    from employee;</span><br><span class="line"><span class="tag">&lt;/<span class="name">sql</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;ha&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">include</span> <span class="attr">refid</span>=<span class="string">&quot;select&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;other&quot;</span> <span class="attr">value</span>=<span class="string">&quot;age&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">    where id=#&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>我们可以使用 sql 标签抽取 sql模板，然后使用 include 标签应用模板，之所以称为模板说的是他们是可以被重用的并且里面的内容是可变的。我们可以在 include 中使用 property 标签向模板中注入我们的定义的变量，只不过要注意的是变量的名字必须是采用 ${} 不能是 #{}</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2018/06/02/DataBase/MyBatis%E7%AC%94%E8%AE%B0%E5%9B%9B%EF%BC%9A%E5%8A%A8%E6%80%81SQL/" data-id="cmblmb66f0026l6ofhukage69" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java/" rel="tag">Java</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MyBatis/" rel="tag">MyBatis</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" rel="tag">数据库</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-DataBase/MyBatis笔记三：SQL映射文件" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/05/31/DataBase/MyBatis%E7%AC%94%E8%AE%B0%E4%B8%89%EF%BC%9ASQL%E6%98%A0%E5%B0%84%E6%96%87%E4%BB%B6/" class="article-date">
  <time datetime="2018-05-31T19:56:49.000Z" itemprop="datePublished">2018-05-31</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/MyBatis/">MyBatis</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/05/31/DataBase/MyBatis%E7%AC%94%E8%AE%B0%E4%B8%89%EF%BC%9ASQL%E6%98%A0%E5%B0%84%E6%96%87%E4%BB%B6/">MyBatis笔记三：SQL映射文件</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="MyBatis笔记三：SQL映射文件"><a href="#MyBatis笔记三：SQL映射文件" class="headerlink" title="MyBatis笔记三：SQL映射文件"></a>MyBatis笔记三：SQL映射文件</h1><h2 id="1-简单的CRUD"><a href="#1-简单的CRUD" class="headerlink" title="1.简单的CRUD"></a>1.简单的CRUD</h2><h3 id="1-绑定"><a href="#1-绑定" class="headerlink" title="1.绑定"></a>1.绑定</h3><p>首先呢我们还是需要把我们的 Mapper 接口和我们的 mapper xml 进行绑定，绑定的方式就是采用 <code>namespace</code> 了。不具体多说了。</p>
<h3 id="2-接口"><a href="#2-接口" class="headerlink" title="2.接口"></a>2.接口</h3><p>接着就是写我们的 Mapper 接口了，写Mapper接口的时候有一些注意事项，就是我们的 <code>插删改</code> 操作是可以有返回值的，默认情况下这些都是返回我们影响的行数，但是这里我们可以返回 <code>Integer</code> , <code>Long</code> , <code>Boolean</code> 类型，前两个好理解，就是我们常见的那种行数。然后后面具体就是布尔值是我们的行数大于0 就返回真。当然我们也可以不返回：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> lwen.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lwen.entries.Employee;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">EmployeeMapper</span> </span>&#123;</span><br><span class="line">    <span class="function">Employee <span class="title">getEmployeeById</span><span class="params">(Integer id)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">addEmpl</span><span class="params">(Employee employee)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">updateEmpl</span><span class="params">(Employee employee)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">deleteEmpl</span><span class="params">(Integer id)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-mapper-xml"><a href="#3-mapper-xml" class="headerlink" title="3.mapper xml"></a>3.mapper xml</h3><p>然后就是在 mapper 的 xml文件中写 sql 语句了，具体就是几个 <code>动作标签</code> ，然后里面配置上我们的 sql ，至于我们的 sql 的参数我们采用了 <code>#&#123;..&#125;</code> 的方式，然后就是我们需要注意的一点就是我们的 sql 标签的 select 标签是含有一个返回值类型的，但是其他的标签是没有的，需要注意一下。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot; -//mybatis.org//DTD Mapper 3.e//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;lwen.dao.EmployeeMapper&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;selectOneEmployee&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;lwen.entries.Employee&quot;</span>&gt;</span></span><br><span class="line">      select * from employee where id=#&#123;id&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--添加--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">&quot;addEmpl&quot;</span>&gt;</span></span><br><span class="line">        insert into employee (name, age) values (#&#123;name&#125;, #&#123;age&#125;)</span><br><span class="line">    <span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--修改--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">&quot;updateEmpl&quot;</span>&gt;</span></span><br><span class="line">        update employee</span><br><span class="line">        set name = #&#123;name&#125;, age = #&#123;age&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--删除--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">delete</span> <span class="attr">id</span>=<span class="string">&quot;deleteEmpl&quot;</span>&gt;</span></span><br><span class="line">        delete from employee where id=#&#123;id&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">delete</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="4-测试类"><a href="#4-测试类" class="headerlink" title="4.测试类"></a>4.测试类</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">CURDTest</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">    SqlSessionFactory sessionFactory = GettingStart.getSessionFactory(<span class="string">&quot;mybatis.xml&quot;</span>);</span><br><span class="line">    SqlSession sqlSession = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        sqlSession = sessionFactory.openSession(<span class="keyword">true</span>);</span><br><span class="line">        EmployeeMapper mapper = sqlSession.getMapper(EmployeeMapper.class);</span><br><span class="line">        System.out.println(mapper.addEmpl(<span class="keyword">new</span> Employee(<span class="number">1</span>,<span class="string">&quot;lwen&quot;</span>,<span class="number">18</span>)));</span><br><span class="line">    &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (sqlSession != <span class="keyword">null</span>) &#123;</span><br><span class="line">            sqlSession.close();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>测试类的地方我们也看到了一个比较奇怪的地方就是 <code> sqlSession = sessionFactory.openSession(true);</code> 我们在获取 session 的时候加了一个参数，其实这个参数就是说我们的每一条sql是否为一个事物，或者说是不是一个自动提交的 sql 。如果我们不开启这个自动提交的话我们在执行完若干条sql以后我们需要手动的调用 sql 的 <code>sqlSession.commit();</code> 方法了。</p>
<h2 id="2-获取自增主键"><a href="#2-获取自增主键" class="headerlink" title="2.获取自增主键"></a>2.获取自增主键</h2><p>我们在 Mybatis 中需要将我们插入的值获取到，然后返回给我们传入的 JavaBean 的话我们就可以才用这个方式把自动增长的主键的值封装获取我们在 Service  层就可以获取到我们插入的数据的 id 。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">&quot;addEmpl&quot;</span> <span class="attr">useGeneratedKeys</span>=<span class="string">&quot;true&quot;</span> <span class="attr">keyProperty</span>=<span class="string">&quot;id&quot;</span>&gt;</span></span><br><span class="line">    insert into employee (name, age) values (#&#123;name&#125;, #&#123;age&#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><code>useGeneratedKeys</code> 这个属性说我们需要开启自动增长的策略并获取增长的值，然后我们需要把这个值封装进我们的 Java bean 的哪个属性就是我们的 <code>keyProperty</code> 来确定了。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Employee employee = <span class="keyword">new</span> Employee(<span class="number">1</span>, <span class="string">&quot;lwen&quot;</span>, <span class="number">18</span>);</span><br><span class="line">System.out.println(mapper.addEmpl(employee));</span><br><span class="line">System.out.println(employee);</span><br></pre></td></tr></table></figure>

<p><code>Employee(id=13, name=lwen, age=18)</code> 虽然我们传入了 id=1 但是 bean 被修改成了 13。</p>
<h2 id="3-参数处理"><a href="#3-参数处理" class="headerlink" title="3.参数处理"></a>3.参数处理</h2><h3 id="1-单个参数"><a href="#1-单个参数" class="headerlink" title="1.单个参数"></a>1.单个参数</h3><p>这个时候我们直接采用 <code>#&#123;&#125;</code> 取出值，不做特殊处理，我们的 <code>#&#123;&#125;</code> 里面写什么都可以，不用和我们的方法参数对应。</p>
<h3 id="2-多个参数"><a href="#2-多个参数" class="headerlink" title="2.多个参数"></a>2.多个参数</h3><p>多个参数就设计到绑定的问题了，也就是要么我们进行参数的绑定，要么我们就进行参数的顺序处理。</p>
<h4 id="1-param顺序处理"><a href="#1-param顺序处理" class="headerlink" title="1.param顺序处理"></a>1.param顺序处理</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getEmplByIdAndName&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;lwen.entries.Employee&quot;</span>&gt;</span></span><br><span class="line">    select * from employee where id=#&#123;param1&#125; and name=#&#123;param2&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>这里我们的 Java 代码是有两个参数的，所以注意我们的这个地方参数是从 1 开始的不是 0.</p>
<h4 id="2-args顺序处理"><a href="#2-args顺序处理" class="headerlink" title="2.args顺序处理"></a>2.args顺序处理</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getEmplByIdAndName2&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;lwen.entries.Employee&quot;</span>&gt;</span></span><br><span class="line">    select * from employee where id=#&#123;arg0&#125; and name=#&#123;arg1&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>这里的参数有是从 0 开始的。</p>
<p><strong>注意：</strong> 以上两种代码我们的 Mapper 接口不需要做任何的额外的配置，就可以直接可以工作了如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">Employee <span class="title">getEmplByIdAndName</span><span class="params">(Integer id, String name)</span></span>;</span><br></pre></td></tr></table></figure>

<h4 id="3-命名参数"><a href="#3-命名参数" class="headerlink" title="3.命名参数"></a>3.命名参数</h4><p>上面的代码虽然可以工作但是我们需要注意的就是这个地方我们的代码是没有任何的具体的意义的，因为就是我们看不出来这个变量的具体意义。我们就可以和我们的接口的参数绑定，那么就是用命名参数。</p>
<p>首先我们需要在Mapper接口中写相关的注解，确定参数：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">Employee <span class="title">getEmplByIdAndName1</span><span class="params">(<span class="meta">@Param(&quot;id&quot;)</span> Integer id,<span class="meta">@Param(&quot;name&quot;)</span> String name)</span></span>;</span><br></pre></td></tr></table></figure>

<p>然后我们在 xml 中就可以应用这些参数了：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getEmplByIdAndName1&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;lwen.entries.Employee&quot;</span>&gt;</span></span><br><span class="line">    select * from employee where id=#&#123;id&#125; and name=#&#123;name&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>当然采用命名参数肯定是最好的方式了。</p>
<h3 id="3-传递pojo"><a href="#3-传递pojo" class="headerlink" title="3.传递pojo"></a>3.传递pojo</h3><p>如果我们的参数太多了我们使用命名参数就很麻烦，我们就可以自己构建 pojo 。但是如果这些属性之间没什么关系，然后我们不用自己创建一个没什么用的封装类，我们直接使用 map 就好了。然后我们在 sql 就可以直接使用 <code>#&#123;key&#125;</code> 就可以获取对应的 value 。但是如果这个参数经常被使用的话我们就可以自己封装一个类数据传输类 TO。</p>
<p>其实真正在 Mybatis 中他自动把我们的参数封装到了 map中所以我们这么写也是很自然的。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">Employee <span class="title">getEmplByIdAndName3</span><span class="params">(Map&lt;String, Object&gt; map)</span></span>;</span><br></pre></td></tr></table></figure>

<p>我们的xml 可以直接取出我们的map中的key</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getEmplByIdAndName3&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;lwen.entries.Employee&quot;</span>&gt;</span></span><br><span class="line">    select * from employee where id=#&#123;id&#125; and name=#&#123;name&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Map&lt;String, Object&gt; map = <span class="keyword">new</span> HashMap();</span><br><span class="line">map.put(<span class="string">&quot;id&quot;</span>, <span class="number">12</span>);</span><br><span class="line">map.put(<span class="string">&quot;name&quot;</span>, <span class="string">&quot;lwen&quot;</span>);</span><br><span class="line">Employee employee4 = mapper.getEmplByIdAndName3(map);</span><br></pre></td></tr></table></figure>

<h3 id="4-List-Array-特殊情况"><a href="#4-List-Array-特殊情况" class="headerlink" title="4.List/Array 特殊情况"></a>4.List/Array 特殊情况</h3><ul>
<li><p>public Employee getEmp(@Param(“id”)Integer id,String lastName)；</p>
<p>取值：id ： #{id/param1}  lastName ：#{param2}</p>
</li>
<li><p>public Employee getEmp(Integer id,@Param(“e”)Employee emp)；</p>
<p>取值：id： #{param1}   lastName：#{param2.lastName/e.lastName}</p>
</li>
</ul>
<p><strong>特别注意</strong>：</p>
<p>如果是Collection(List、Set)类型或者是数组，也会特殊处理。也是把传入的list或者数组封装在map中。</p>
<p>比如：public Employee getEmpById(List<Integer>ids)；</p>
<p>取值：取出第一个id的值：#{list[e]}</p>
<h2 id="4-参数处理原理"><a href="#4-参数处理原理" class="headerlink" title="4.参数处理原理"></a>4.参数处理原理</h2><p>我们从源码的角度来看看我们的 Mybatis 框架是如何处理我们的传入的参数，以及绑定的参数的。</p>
<h3 id="1-代理对象"><a href="#1-代理对象" class="headerlink" title="1.代理对象"></a>1.代理对象</h3><p>首先我们在获取到的 mapper 上打断点，然后 step into：</p>
<p><img src="https://user-images.githubusercontent.com/22151420/40818854-e5a7c90a-658b-11e8-93db-196954b83166.png" alt="image"></p>
<p>接着我们就能来到代理类了：<code>org.apache.ibatis.binding.MapperProxy</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Object <span class="title">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="comment">//放行Object对象的方法，不做代理</span></span><br><span class="line">    <span class="keyword">if</span> (Object.class.equals(method.getDeclaringClass())) &#123;</span><br><span class="line">      <span class="keyword">return</span> method.invoke(<span class="keyword">this</span>, args);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (isDefaultMethod(method)) &#123;</span><br><span class="line">      <span class="keyword">return</span> invokeDefaultMethod(proxy, method, args);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">catch</span> (Throwable t) &#123;</span><br><span class="line">    <span class="keyword">throw</span> ExceptionUtil.unwrapThrowable(t);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">final</span> MapperMethod mapperMethod = cachedMapperMethod(method);</span><br><span class="line">   <span class="comment">//真正执行的 sqlSession</span></span><br><span class="line">  <span class="keyword">return</span> mapperMethod.execute(sqlSession, args);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可以看到我们在这里生成了对应方法的代理对象，也就是给我们的 Mapper 接口生成了代理对象，接着就用代理对象 <code>mapperMethod</code> 来调用我们的接口方法。</p>
<h3 id="2-execute核心逻辑"><a href="#2-execute核心逻辑" class="headerlink" title="2.execute核心逻辑"></a>2.execute核心逻辑</h3><p>我们单步进入 execute 方法可以看到主要的逻辑如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">switch</span> (command.getType()) &#123;</span><br><span class="line">  <span class="keyword">case</span> INSERT: &#123;</span><br><span class="line">    Object param = method.convertArgsToSqlCommandParam(args);</span><br><span class="line">    result = rowCountResult(sqlSession.insert(command.getName(), param));</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">case</span> UPDATE: &#123;</span><br><span class="line">    Object param = method.convertArgsToSqlCommandParam(args);</span><br><span class="line">    result = rowCountResult(sqlSession.update(command.getName(), param));</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">case</span> DELETE: &#123;</span><br><span class="line">    Object param = method.convertArgsToSqlCommandParam(args);</span><br><span class="line">    result = rowCountResult(sqlSession.delete(command.getName(), param));</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">case</span> SELECT:</span><br><span class="line">    <span class="keyword">if</span> (method.returnsVoid() &amp;&amp; method.hasResultHandler()) &#123;</span><br><span class="line">      executeWithResultHandler(sqlSession, args);</span><br><span class="line">      result = <span class="keyword">null</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (method.returnsMany()) &#123;</span><br><span class="line">      result = executeForMany(sqlSession, args);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (method.returnsMap()) &#123;</span><br><span class="line">      result = executeForMap(sqlSession, args);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (method.returnsCursor()) &#123;</span><br><span class="line">      result = executeForCursor(sqlSession, args);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      Object param = method.convertArgsToSqlCommandParam(args);</span><br><span class="line">      result = sqlSession.selectOne(command.getName(), param);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  <span class="keyword">case</span> FLUSH:</span><br><span class="line">    result = sqlSession.flushStatements();</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  <span class="keyword">default</span>:</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> BindingException(<span class="string">&quot;Unknown execution method for: &quot;</span> + command.getName());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>也就是我们所有的采用Mapper 接口的方法开发的最后采用的代理生成代理对象以后我们的插删改操作还是调用了我们 sqlSession 底层的 Select、Delete 方法等等。</p>
<p>里面的套路就是先对我们的方法的参数进行转换，然后执行对应的动作方法，传入我们的参数。</p>
<h3 id="3-参数转换"><a href="#3-参数转换" class="headerlink" title="3.参数转换"></a>3.参数转换</h3><p><code>convertArgsToSqlCommandParam（）</code> 主要完成了这个功能，这里我们就着重看看这个方法。</p>
<p>最后追溯到下面这个方法，代码补偿我就全部贴上来了：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Object <span class="title">getNamedParams</span><span class="params">(Object[] args)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">final</span> <span class="keyword">int</span> paramCount = names.size();</span><br><span class="line">  <span class="keyword">if</span> (args == <span class="keyword">null</span> || paramCount == <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (!hasParamAnnotation &amp;&amp; paramCount == <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> args[names.firstKey()];</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">final</span> Map&lt;String, Object&gt; param = <span class="keyword">new</span> ParamMap&lt;Object&gt;();</span><br><span class="line">    <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (Map.Entry&lt;Integer, String&gt; entry : names.entrySet()) &#123;</span><br><span class="line">      param.put(entry.getValue(), args[entry.getKey()]);</span><br><span class="line">      <span class="comment">// add generic param names (param1, param2, ...)</span></span><br><span class="line">      <span class="keyword">final</span> String genericParamName = GENERIC_NAME_PREFIX + String.valueOf(i + <span class="number">1</span>);</span><br><span class="line">      <span class="comment">// ensure not to overwrite parameter named with @Param</span></span><br><span class="line">      <span class="keyword">if</span> (!names.containsValue(genericParamName)) &#123;</span><br><span class="line">        param.put(genericParamName, args[entry.getKey()]);</span><br><span class="line">      &#125;</span><br><span class="line">      i++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> param;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我们看看这个方法的执行逻辑：</p>
<h4 id="1-names获取"><a href="#1-names获取" class="headerlink" title="1.names获取"></a>1.names获取</h4><p>首先就是一堆names的获取，这个names又是什么？其实这是当前类的一个属性，记录的东西是Mapper 接口的参数的名字他是在这个类的构造方法中初始化的，也就是在我们调用方法之前 names 就已经确定好了。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// get names from @Param annotations</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> paramIndex = <span class="number">0</span>; paramIndex &lt; paramCount; paramIndex++) &#123;</span><br><span class="line">  <span class="keyword">if</span> (isSpecialParameter(paramTypes[paramIndex])) &#123;</span><br><span class="line">    <span class="comment">// skip special parameters</span></span><br><span class="line">    <span class="keyword">continue</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  String name = <span class="keyword">null</span>;</span><br><span class="line">  <span class="keyword">for</span> (Annotation annotation : paramAnnotations[paramIndex]) &#123;</span><br><span class="line">    <span class="keyword">if</span> (annotation <span class="keyword">instanceof</span> Param) &#123;</span><br><span class="line">      hasParamAnnotation = <span class="keyword">true</span>;</span><br><span class="line">      name = ((Param) annotation).value();</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (name == <span class="keyword">null</span>) &#123;</span><br><span class="line">    <span class="comment">// @Param was not specified.</span></span><br><span class="line">    <span class="keyword">if</span> (config.isUseActualParamName()) &#123;</span><br><span class="line">      name = getActualParamName(method, paramIndex);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (name == <span class="keyword">null</span>) &#123;</span><br><span class="line">      <span class="comment">// use the parameter index as the name (&quot;0&quot;, &quot;1&quot;, ...)</span></span><br><span class="line">      <span class="comment">// gcode issue #71</span></span><br><span class="line">      name = String.valueOf(map.size());</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  map.put(paramIndex, name);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这就是 <code>ParamNameResolver</code> 的构造函数，里面最重要的逻辑就是确定我们的 names ：</p>
<p>1.获取 <code>@param</code> 注解标注的参数名，然后把这个注解的value值作为 names 的value，然后把参数的位置作为 key 。比如我们的方法是 <code>findAll(@Parma(&quot;name&quot;) String name,Integer age)</code> 最后生成的names这个map里面就是 {0-&gt;name,1-&gt;1} 至于为什么是 <code>1-&gt;1</code> 我们接下来再说</p>
<p>2.如果我们的 <code>@param</code> 不存在的话并且我们配置了 <code>isUseActualParamName</code> 我们会尝试采用 JDK1.8 的新特性也就是使用 -paramters 编译参数，通过反射直接获取到我们方法的参数名。</p>
<p>3.如果还是不行的话我们就使用参数的索引值，也就是 0,1 上面的注释也是特别清楚。</p>
<h4 id="2-方法没有参数"><a href="#2-方法没有参数" class="headerlink" title="2.方法没有参数"></a>2.方法没有参数</h4><p>没有参数的时候就会直接返回null</p>
<h4 id="3-单参数"><a href="#3-单参数" class="headerlink" title="3.单参数"></a>3.单参数</h4><p>只有一个参数并且没有 <code>@param</code> 注解的时候，我们就直接获取names的第一个key也就是0</p>
<h4 id="4-多参数"><a href="#4-多参数" class="headerlink" title="4.多参数"></a>4.多参数</h4><p>这个地方有两部分，当有 <code>@Param</code> 注解的时候就是把 names 的 value 作为 key ，然后我们的真正的参数作为 value 。然后当然为了保险起见 Mybatis 还未每一个参数生成了一个 以 paramIndex 作为key 以值作为 value 的 也就是我们用的 param0 .. paramN .可是我们会说为啥我们还可以用 args0 和 args1 来取值呢？</p>
<p>这个就看上面的 names 获取值的时候我们可以采用编译器的反射机制获取，因为如果我们编译器不支持这个特性的话我们的参数就会被抹掉，用args0 args1 来代替。</p>
<h2 id="5-取值规则"><a href="#5-取值规则" class="headerlink" title="5.取值规则"></a>5.取值规则</h2><h3 id="1-与-区别"><a href="#1-与-区别" class="headerlink" title="1.#{}与${}区别"></a>1.#{}与${}区别</h3><p>#{}：是以预编译的形式，将参数设置到sq1语句中；PreparedStatement；防止sq1注入</p>
<p>${}：取出的值直接拼装在sq1语句中；会有安全问题；<br>大多情况下，我们去参数的值都应该去使用#{}；<br>原生jdbc不支持占位符的地方我们就可以使用${}进行取值,比如分表；按照年份分表拆分<br><code>select * from $&#123;year&#125;_salary where xxx；</code></p>
<h3 id="2-注意事项"><a href="#2-注意事项" class="headerlink" title="2.#{}注意事项"></a>2.#{}注意事项</h3><p>在#{} 中我们可以放入 javaType、jdbcType、mode(存储过程）、numericScale、<br>resultMap、typeHandler、jdbcTypeName、expression(未来准备支持的功能）；</p>
<p>比较重要的就是：jdbcType通常需要在某种特定的条件下被设置：<br>在我们数据为null的时候，有些数据库可能不能识别mybatis对nu11的默认处理。比如Oracle（报错），因为他们对null的映射是到了 Other 类型，然后就会导致JdbcType OTHER：无效的类型；因为mybatis对所有的nu11都映射的是原生Jdbc的OTHER类型，<br>由于全局配置中：jdbcTypeForNull=OTHER；oracle不支持；两种办法<br>1、<code>#&#123;email,jdbcType=OTHER&#125;；</code><br>2、<code>&lt;setting name=&quot;jdbcTypeForNull&quot; value=&quot;NULL&quot;/&gt;</code></p>
<h2 id="6-查询"><a href="#6-查询" class="headerlink" title="6.查询"></a>6.查询</h2><h3 id="1-返回集合结果"><a href="#1-返回集合结果" class="headerlink" title="1.返回集合结果"></a>1.返回集合结果</h3><p>返回集合结果的时候我们的 resultType 不能写成 list 、set 类型而是要写做我们的集合里面的元素的类型。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getLikeByName&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;lwen.entries.Employee&quot;</span>&gt;</span></span><br><span class="line">    select *</span><br><span class="line">    from employee</span><br><span class="line">    where name like #&#123;name&#125;;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="2-返回map"><a href="#2-返回map" class="headerlink" title="2.返回map"></a>2.返回map</h3><p>也就是将我们的 bean 的属性作为 key 然后 值作为 value 来存储到一个 map 中，其实这个只存一条数据，那么我们的语句的返回类型就是我们的 map 他会自动的做封装。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getEmplReturenMap&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;map&quot;</span>&gt;</span></span><br><span class="line">    select * from employee where id=#&#123;id&#125;;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">Map&lt;String, Object&gt; <span class="title">getEmplReturenMap</span><span class="params">(Integer id)</span></span>;</span><br></pre></td></tr></table></figure>

<h3 id="3-返回多条记录的map"><a href="#3-返回多条记录的map" class="headerlink" title="3.返回多条记录的map"></a>3.返回多条记录的map</h3><p>如果我们想让map的key是我们的某一条属性，然后value是我们的实体对象，那么我们的封装结果就必须是元素的类型，也就是我们的实体类的类型，但是我们的key则需要我们另行指定我们采用的方式就是使用一个注解在方法上。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@MapKey(&quot;name&quot;)</span></span><br><span class="line"><span class="function">Map&lt;String, Employee&gt; <span class="title">getEmplReturnMaps</span><span class="params">(String name)</span></span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getEmplReturnMaps&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;lwen.entries.Employee&quot;</span>&gt;</span></span><br><span class="line">    select *</span><br><span class="line">    from employee where name like #&#123;name&#125;;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="4-返回自定义结果集"><a href="#4-返回自定义结果集" class="headerlink" title="4.返回自定义结果集"></a>4.返回自定义结果集</h3><p>有时候对于Mybatis自带的一些默认封装的规则不能满足我们的需求的时候，我们可以采用 resultMap 自定义结果集。这里就演示一些自定义结果集，但是注意 resultMap 与 resultType 只能存在一个。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;MyEmp&quot;</span> <span class="attr">type</span>=<span class="string">&quot;lwen.entries.Employee&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">&quot;id&quot;</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;name&quot;</span> <span class="attr">property</span>=<span class="string">&quot;name&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;age&quot;</span> <span class="attr">property</span>=<span class="string">&quot;age&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getEmplByResultMap&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;MyEmp&quot;</span>&gt;</span></span><br><span class="line">    select *</span><br><span class="line">    from employee</span><br><span class="line">    where id = #&#123;id&#125;;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>可以看到重点就是写我们的 resultMap 标签，然后再标签中我们自己封装规则。注意的一点就是如果说我们在 result 中没有封装 bean 中的其他属性他会自动帮我们封装，也就是我们可以把一些特殊的字段和我们的 bean 结合起来。其他的正常的自动封装。然后就是 id 字段我们在 resultMap 中指明以后Mybatis就会帮我们自动封装，并且做一些查询优化。</p>
<h3 id="5-关联查询"><a href="#5-关联查询" class="headerlink" title="5.关联查询"></a>5.关联查询</h3><h4 id="1-union"><a href="#1-union" class="headerlink" title="1.union"></a>1.union</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getById&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;EmpNew&quot;</span>&gt;</span></span><br><span class="line">    select employee.id id,employee.name name,age,d_id did,department.name dname</span><br><span class="line">    from employee,department where employee.id=#&#123;id&#125; and employee.d_id=department.id;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>我们采用的联合查询，得到了关联查询的结果，这也是常用的套路，但是注意的一点就是我们的 result 的封装并不是使用的自带的封装规则而是采用了 我们自定义的 resultMap 因为我们的 employee 中有一个 department 的对象，我们无法直接封装，至少列名都没办法对应。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;EmpNew&quot;</span> <span class="attr">type</span>=<span class="string">&quot;lwen.entries.EmployeeNew&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">&quot;id&quot;</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;name&quot;</span> <span class="attr">property</span>=<span class="string">&quot;name&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;age&quot;</span> <span class="attr">property</span>=<span class="string">&quot;age&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;did&quot;</span> <span class="attr">property</span>=<span class="string">&quot;department.id&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;dname&quot;</span> <span class="attr">property</span>=<span class="string">&quot;department.name&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="2-association关联"><a href="#2-association关联" class="headerlink" title="2.association关联"></a>2.association关联</h4><p>使用 association 标签可以给一个 javaBean 的内部引用创建关联关系，与上面的效果类似，但是方法不同。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;EmpNew1&quot;</span> <span class="attr">type</span>=<span class="string">&quot;lwen.entries.EmployeeNew&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">&quot;id&quot;</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;name&quot;</span> <span class="attr">property</span>=<span class="string">&quot;name&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;age&quot;</span> <span class="attr">property</span>=<span class="string">&quot;age&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">&quot;department&quot;</span> <span class="attr">javaType</span>=<span class="string">&quot;lwen.entries.Department&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">&quot;did&quot;</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;dname&quot;</span> <span class="attr">property</span>=<span class="string">&quot;name&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">association</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getByIdAssociation&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;EmpNew1&quot;</span>&gt;</span></span><br><span class="line">    select employee.id id,employee.name name,age,d_id did,department.name dname</span><br><span class="line">    from employee,department where employee.id=#&#123;id&#125; and employee.d_id=department.id;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="3-association多步查询"><a href="#3-association多步查询" class="headerlink" title="3.association多步查询"></a>3.association多步查询</h4><p>当我们需要 department 的 id 然后作为我们封装 Employee 的条件的时候我们就需要用 id 查询这个 Department</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;EmpNew2&quot;</span> <span class="attr">type</span>=<span class="string">&quot;EmployeeNew&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">&quot;id&quot;</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;name&quot;</span> <span class="attr">property</span>=<span class="string">&quot;name&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;age&quot;</span> <span class="attr">property</span>=<span class="string">&quot;age&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">&quot;department&quot;</span> <span class="attr">select</span>=<span class="string">&quot;lwen.dao.DepartmentMapper.getDepById&quot;</span> <span class="attr">column</span>=<span class="string">&quot;d_id&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">association</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getEmplStepByStep&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;EmpNew2&quot;</span>&gt;</span></span><br><span class="line">    select * from employee where id=#&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getDepById&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;lwen.entries.Department&quot;</span>&gt;</span></span><br><span class="line">    select * from department where id=#&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>可以看到我们在 <code>association</code> 中调用了  <code>lwen.dao.DepartmentMapper.getDepById</code>  这个方法其实就是只进行了一个简单的 按照 id 查询，然后我们传入的 column 就是作为我们查询 department 的参数。最后做关联。</p>
<h4 id="4-懒加载"><a href="#4-懒加载" class="headerlink" title="4.懒加载"></a>4.懒加载</h4><p>需要我们在以前的分布查询的基础之上添加上一个配置项，这个配置项是在我们的全局配置文件中的。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;lazyloadingEnabled&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;aggressivelazyLoading&quot;</span> <span class="attr">value</span>=<span class="string">&quot;false&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>配置这两项的时候我们在查询获取一个对象的时候我们只有在引用他们的值得时候才真的去加载这些东西，否则不会加载。</p>
<h4 id="5-一对多映射"><a href="#5-一对多映射" class="headerlink" title="5.一对多映射"></a>5.一对多映射</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;EmpNew3&quot;</span> <span class="attr">type</span>=<span class="string">&quot;Department&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">&quot;id&quot;</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">&quot;name&quot;</span> <span class="attr">property</span>=<span class="string">&quot;name&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">&quot;employees&quot;</span> <span class="attr">select</span>=<span class="string">&quot;lwen.dao.EmployeeNewMapper.getEmplsByDeptId&quot;</span> <span class="attr">column</span>=<span class="string">&quot;id&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getEmplStepByDepIdStep&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;EmpNew3&quot;</span>&gt;</span></span><br><span class="line">    select *</span><br><span class="line">    from department where id=#&#123;id&#125;;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getEmplsByDeptId&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;lwen.entries.Employee&quot;</span>&gt;</span></span><br><span class="line">    select * from employee where d_id=#&#123;did&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2018/05/31/DataBase/MyBatis%E7%AC%94%E8%AE%B0%E4%B8%89%EF%BC%9ASQL%E6%98%A0%E5%B0%84%E6%96%87%E4%BB%B6/" data-id="cmblmb6c100ppl6ofdoh6bjy7" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java/" rel="tag">Java</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MyBatis/" rel="tag">MyBatis</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" rel="tag">数据库</a></li></ul>

    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/5/">&amp;laquo; Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/4/">4</a><a class="page-number" href="/page/5/">5</a><span class="page-number current">6</span><a class="page-number" href="/page/7/">7</a><a class="page-number" href="/page/8/">8</a><span class="space">&hellip;</span><a class="page-number" href="/page/23/">23</a><a class="extend next" rel="next" href="/page/7/">Next &amp;raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Atom/">-Atom</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/JAVA/">-JAVA</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Java/">-Java</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Java-%E8%99%9A%E6%8B%9F%E6%9C%BA/">-Java -虚拟机</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Java-Web/">-Java Web</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/JavaWeb/">-JavaWeb</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/LeetCode/">-LeetCode</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Linux/">-Linux</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Mac/">-Mac</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/MacOS/">-MacOS</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/PHP/">-PHP</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/SpringBoot/">-SpringBoot</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/leetcode/">-leetcode</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%85%B6%E4%BB%96/">-其他</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%B0%8F%E8%AE%B0/">-小记</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%B7%A5%E5%85%B7%E7%B1%BB/">-工具类</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/">-开发工具</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">-数据库</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/">-数据结构</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/">-数据结构与算法</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%9D%82%E6%96%87/">-杂文</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%9D%82%E8%AE%B0/">-杂记</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%94%9F%E6%B4%BB/">-生活</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%AE%97%E6%B3%95%E8%AE%BE%E8%AE%A1/">-算法设计</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/">-计算机网络</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Docker/">Docker</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/FrontEnd/">FrontEnd</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/JAVA/">JAVA</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/JAVA/Java%E5%B7%A5%E5%85%B7%E5%8C%85/">Java工具包</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/JAVA/LOG/">LOG</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/JDK-%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/">JDK 源码分析</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Java/">Java</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Kafka-%E6%8E%A2%E9%99%A9/">Kafka 探险</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/LeetCode/">LeetCode</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Linux/">Linux</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/MyBatis/">MyBatis</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Mybatis/">Mybatis</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Netty/">Netty</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Netty-%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/">Netty 源码分析</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/PHP/">PHP</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/PT%E7%AB%99/">PT站</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Shiro/">Shiro</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Spark/">Spark</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Spring-Fu/">Spring Fu</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Spring-%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/">Spring 源码分析</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Spring-%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/Spring/">Spring</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/SpringBoot/">SpringBoot</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/SpringCloud/">SpringCloud</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/SpringFu/">SpringFu</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/SpringFu/Spring/">Spring</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/SpringMVC/">SpringMVC</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Tomcat/">Tomcat</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Web/">Web</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/git/">git</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%B7%A5%E5%85%B7/">工具</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%B7%A5%E5%85%B7%E9%9B%86/">工具集</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/">开发工具</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%96%87%E7%AB%A0/">文章</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%9C%8D%E5%8A%A1%E5%99%A8/">服务器</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%9C%8D%E5%8A%A1%E5%99%A8/Linux/">Linux</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%9D%82%E8%AE%B0/">杂记</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%94%9F%E6%B4%BB/">生活</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%94%9F%E6%B4%BB/%E9%98%BF%E9%87%8C%E5%B7%B4%E5%B7%B4/">阿里巴巴</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%94%9F%E6%B4%BB/%E9%98%BF%E9%87%8C%E5%B7%B4%E5%B7%B4/%E5%BC%80%E5%BF%83/">开心</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%94%9F%E6%B4%BB%E5%B0%8F%E8%AE%B0/">生活小记</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%94%9F%E6%B4%BB%E6%84%9F%E6%82%9F/">生活感悟</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%A7%86%E9%A2%91%E5%90%8E%E6%9C%9F/">视频后期</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/">设计模式</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/MacOS/" rel="tag">-MacOS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CSS/" rel="tag">CSS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DB-MangoDB/" rel="tag">DB MangoDB</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Docker/" rel="tag">Docker</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Filter/" rel="tag">Filter</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hibernate/" rel="tag">Hibernate</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/IO/" rel="tag">IO</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JAVA/" rel="tag">JAVA</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JDBC/" rel="tag">JDBC</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JDK-%E6%BA%90%E7%A0%81/" rel="tag">JDK 源码</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JDK-%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/" rel="tag">JDK 源码分析</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JVM-Java-%E8%99%9A%E6%8B%9F%E6%9C%BA/" rel="tag">JVM Java 虚拟机</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Java/" rel="tag">Java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Java-Web/" rel="tag">Java Web</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Java-%E5%B7%A5%E5%85%B7%E5%8C%85/" rel="tag">Java 工具包</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Java-%E8%99%9A%E6%8B%9F%E6%9C%BA/" rel="tag">Java 虚拟机</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Java8/" rel="tag">Java8</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JavaScript/" rel="tag">JavaScript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JavaWeb/" rel="tag">JavaWeb</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Java%E5%AD%A6%E4%B9%A0/" rel="tag">Java学习</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Java%E5%B7%A5%E5%85%B7/" rel="tag">Java工具</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Kafka-%E6%8E%A2%E9%99%A9/" rel="tag">Kafka 探险</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/LeetCode/" rel="tag">LeetCode</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/" rel="tag">Linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Mac/" rel="tag">Mac</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MyBatis/" rel="tag">MyBatis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Mybatis/" rel="tag">Mybatis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PHP-%E5%8C%85%E7%AE%A1%E7%90%86%E5%99%A8/" rel="tag">PHP,包管理器</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PHP-%E5%BE%AE%E4%BF%A1/" rel="tag">PHP,微信</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/React/" rel="tag">React</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Redis-NoSql-%E6%95%B0%E6%8D%AE%E5%BA%93/" rel="tag">Redis NoSql 数据库</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Shiro/" rel="tag">Shiro</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Spark/" rel="tag">Spark</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Sping/" rel="tag">Sping</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Spring/" rel="tag">Spring</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Spring-%E6%BA%90%E7%A0%81/" rel="tag">Spring 源码</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SpringBoot/" rel="tag">SpringBoot</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SpringCloud/" rel="tag">SpringCloud</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SpringFu/" rel="tag">SpringFu</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SpringMVC/" rel="tag">SpringMVC</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Struts2/" rel="tag">Struts2</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Vim/" rel="tag">Vim</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Web/" rel="tag">Web</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Webpack/" rel="tag">Webpack</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/" rel="tag">git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/java/" rel="tag">java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/log/" rel="tag">log</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/oh-my-zsh/" rel="tag">oh-my-zsh</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/shadowsocks/" rel="tag">shadowsocks</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/struts2/" rel="tag">struts2</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%B8%BB%E9%A2%98/" rel="tag">主题</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%BA%8C%E5%8F%89%E6%A0%91/" rel="tag">二叉树</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/" rel="tag">动态规划</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%A4%9A%E7%BA%BF%E7%A8%8B/" rel="tag">多线程</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%B7%A5%E5%85%B7/" rel="tag">工具</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%B7%A5%E5%85%B7-WebStrom-JetBrains/" rel="tag">工具 WebStrom JetBrains</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/" rel="tag">开发工具</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%BC%80%E5%BF%83/" rel="tag">开心</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%8E%92%E5%BA%8F/" rel="tag">排序</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E5%AD%97%E5%9B%BE%E5%83%8F/" rel="tag">数字图像</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" rel="tag">数据库</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" rel="tag">数据结构</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%96%87%E7%AB%A0/" rel="tag">文章</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9D%82%E6%96%87/" rel="tag">杂文</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9D%82%E8%AE%B0/" rel="tag">杂记</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%BA%90%E7%A0%81/" rel="tag">源码</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/" rel="tag">源码分析</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%94%9F%E6%B4%BB/" rel="tag">生活</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%94%9F%E6%B4%BB%E6%84%9F%E6%82%9F/" rel="tag">生活感悟</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%99%BE%E9%98%BF/" rel="tag">百阿</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%AE%97%E6%B3%95/" rel="tag">算法</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%AE%97%E6%B3%95%E8%AE%BE%E8%AE%A1/" rel="tag">算法设计</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BB%88%E7%AB%AF/" rel="tag">终端</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%8C%83%E5%9E%8B/" rel="tag">范型</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%A7%86%E9%A2%91%E5%90%8E%E6%9C%9F/" rel="tag">视频后期</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E6%A8%A1%E6%9D%BF%E6%96%B9%E6%B3%95/" rel="tag">设计模式,模板方法</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E7%AD%96%E7%95%A5%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" rel="tag">设计模式,策略设计模式</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E7%BB%84%E5%90%88%E6%A8%A1%E5%BC%8F/" rel="tag">设计模式,组合模式</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E8%A3%85%E9%A5%B0%E8%80%85/" rel="tag">设计模式,装饰者</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E8%A7%82%E5%AF%9F%E8%80%85/" rel="tag">设计模式,观察者</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E8%B4%A3%E4%BB%BB%E9%93%BE/" rel="tag">设计模式,责任链</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E9%80%82%E9%85%8D%E5%99%A8/" rel="tag">设计模式,适配器</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%93%BE%E8%A1%A8/" rel="tag">链表</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%98%BF%E9%87%8C/" rel="tag">阿里</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%9B%86%E5%90%88%E6%A1%86%E6%9E%B6/" rel="tag">集合框架</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/" rel="tag">面向对象</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/MacOS/" style="font-size: 10px;">-MacOS</a> <a href="/tags/CSS/" style="font-size: 12px;">CSS</a> <a href="/tags/DB-MangoDB/" style="font-size: 10px;">DB MangoDB</a> <a href="/tags/Docker/" style="font-size: 10px;">Docker</a> <a href="/tags/Filter/" style="font-size: 10px;">Filter</a> <a href="/tags/Hibernate/" style="font-size: 12px;">Hibernate</a> <a href="/tags/IO/" style="font-size: 10px;">IO</a> <a href="/tags/JAVA/" style="font-size: 10px;">JAVA</a> <a href="/tags/JDBC/" style="font-size: 10px;">JDBC</a> <a href="/tags/JDK-%E6%BA%90%E7%A0%81/" style="font-size: 10px;">JDK 源码</a> <a href="/tags/JDK-%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/" style="font-size: 19px;">JDK 源码分析</a> <a href="/tags/JVM-Java-%E8%99%9A%E6%8B%9F%E6%9C%BA/" style="font-size: 10px;">JVM Java 虚拟机</a> <a href="/tags/Java/" style="font-size: 18px;">Java</a> <a href="/tags/Java-Web/" style="font-size: 10px;">Java Web</a> <a href="/tags/Java-%E5%B7%A5%E5%85%B7%E5%8C%85/" style="font-size: 10px;">Java 工具包</a> <a href="/tags/Java-%E8%99%9A%E6%8B%9F%E6%9C%BA/" style="font-size: 11px;">Java 虚拟机</a> <a href="/tags/Java8/" style="font-size: 14px;">Java8</a> <a href="/tags/JavaScript/" style="font-size: 12px;">JavaScript</a> <a href="/tags/JavaWeb/" style="font-size: 10px;">JavaWeb</a> <a href="/tags/Java%E5%AD%A6%E4%B9%A0/" style="font-size: 10px;">Java学习</a> <a href="/tags/Java%E5%B7%A5%E5%85%B7/" style="font-size: 10px;">Java工具</a> <a href="/tags/Kafka-%E6%8E%A2%E9%99%A9/" style="font-size: 12px;">Kafka 探险</a> <a href="/tags/LeetCode/" style="font-size: 17px;">LeetCode</a> <a href="/tags/Linux/" style="font-size: 11px;">Linux</a> <a href="/tags/Mac/" style="font-size: 10px;">Mac</a> <a href="/tags/MyBatis/" style="font-size: 15px;">MyBatis</a> <a href="/tags/Mybatis/" style="font-size: 10px;">Mybatis</a> <a href="/tags/PHP-%E5%8C%85%E7%AE%A1%E7%90%86%E5%99%A8/" style="font-size: 10px;">PHP,包管理器</a> <a href="/tags/PHP-%E5%BE%AE%E4%BF%A1/" style="font-size: 10px;">PHP,微信</a> <a href="/tags/React/" style="font-size: 10px;">React</a> <a href="/tags/Redis-NoSql-%E6%95%B0%E6%8D%AE%E5%BA%93/" style="font-size: 10px;">Redis NoSql 数据库</a> <a href="/tags/Shiro/" style="font-size: 10px;">Shiro</a> <a href="/tags/Spark/" style="font-size: 14px;">Spark</a> <a href="/tags/Sping/" style="font-size: 10px;">Sping</a> <a href="/tags/Spring/" style="font-size: 17px;">Spring</a> <a href="/tags/Spring-%E6%BA%90%E7%A0%81/" style="font-size: 12px;">Spring 源码</a> <a href="/tags/SpringBoot/" style="font-size: 20px;">SpringBoot</a> <a href="/tags/SpringCloud/" style="font-size: 12px;">SpringCloud</a> <a href="/tags/SpringFu/" style="font-size: 11px;">SpringFu</a> <a href="/tags/SpringMVC/" style="font-size: 12px;">SpringMVC</a> <a href="/tags/Struts2/" style="font-size: 10px;">Struts2</a> <a href="/tags/Vim/" style="font-size: 10px;">Vim</a> <a href="/tags/Web/" style="font-size: 10px;">Web</a> <a href="/tags/Webpack/" style="font-size: 10px;">Webpack</a> <a href="/tags/git/" style="font-size: 10px;">git</a> <a href="/tags/java/" style="font-size: 10px;">java</a> <a href="/tags/log/" style="font-size: 10px;">log</a> <a href="/tags/oh-my-zsh/" style="font-size: 10px;">oh-my-zsh</a> <a href="/tags/shadowsocks/" style="font-size: 10px;">shadowsocks</a> <a href="/tags/struts2/" style="font-size: 11px;">struts2</a> <a href="/tags/%E4%B8%BB%E9%A2%98/" style="font-size: 10px;">主题</a> <a href="/tags/%E4%BA%8C%E5%8F%89%E6%A0%91/" style="font-size: 11px;">二叉树</a> <a href="/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/" style="font-size: 14px;">动态规划</a> <a href="/tags/%E5%A4%9A%E7%BA%BF%E7%A8%8B/" style="font-size: 11px;">多线程</a> <a href="/tags/%E5%B7%A5%E5%85%B7/" style="font-size: 12px;">工具</a> <a href="/tags/%E5%B7%A5%E5%85%B7-WebStrom-JetBrains/" style="font-size: 10px;">工具 WebStrom JetBrains</a> <a href="/tags/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/" style="font-size: 10px;">开发工具</a> <a href="/tags/%E5%BC%80%E5%BF%83/" style="font-size: 11px;">开心</a> <a href="/tags/%E6%8E%92%E5%BA%8F/" style="font-size: 11px;">排序</a> <a href="/tags/%E6%95%B0%E5%AD%97%E5%9B%BE%E5%83%8F/" style="font-size: 10px;">数字图像</a> <a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" style="font-size: 15px;">数据库</a> <a href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" style="font-size: 16px;">数据结构</a> <a href="/tags/%E6%96%87%E7%AB%A0/" style="font-size: 10px;">文章</a> <a href="/tags/%E6%9D%82%E6%96%87/" style="font-size: 11px;">杂文</a> <a href="/tags/%E6%9D%82%E8%AE%B0/" style="font-size: 13px;">杂记</a> <a href="/tags/%E6%BA%90%E7%A0%81/" style="font-size: 14px;">源码</a> <a href="/tags/%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/" style="font-size: 10px;">源码分析</a> <a href="/tags/%E7%94%9F%E6%B4%BB/" style="font-size: 18px;">生活</a> <a href="/tags/%E7%94%9F%E6%B4%BB%E6%84%9F%E6%82%9F/" style="font-size: 11px;">生活感悟</a> <a href="/tags/%E7%99%BE%E9%98%BF/" style="font-size: 11px;">百阿</a> <a href="/tags/%E7%AE%97%E6%B3%95/" style="font-size: 10px;">算法</a> <a href="/tags/%E7%AE%97%E6%B3%95%E8%AE%BE%E8%AE%A1/" style="font-size: 13px;">算法设计</a> <a href="/tags/%E7%BB%88%E7%AB%AF/" style="font-size: 10px;">终端</a> <a href="/tags/%E8%8C%83%E5%9E%8B/" style="font-size: 10px;">范型</a> <a href="/tags/%E8%A7%86%E9%A2%91%E5%90%8E%E6%9C%9F/" style="font-size: 12px;">视频后期</a> <a href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E6%A8%A1%E6%9D%BF%E6%96%B9%E6%B3%95/" style="font-size: 10px;">设计模式,模板方法</a> <a href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E7%AD%96%E7%95%A5%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" style="font-size: 10px;">设计模式,策略设计模式</a> <a href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E7%BB%84%E5%90%88%E6%A8%A1%E5%BC%8F/" style="font-size: 10px;">设计模式,组合模式</a> <a href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E8%A3%85%E9%A5%B0%E8%80%85/" style="font-size: 10px;">设计模式,装饰者</a> <a href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E8%A7%82%E5%AF%9F%E8%80%85/" style="font-size: 10px;">设计模式,观察者</a> <a href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E8%B4%A3%E4%BB%BB%E9%93%BE/" style="font-size: 10px;">设计模式,责任链</a> <a href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E9%80%82%E9%85%8D%E5%99%A8/" style="font-size: 10px;">设计模式,适配器</a> <a href="/tags/%E9%93%BE%E8%A1%A8/" style="font-size: 11px;">链表</a> <a href="/tags/%E9%98%BF%E9%87%8C/" style="font-size: 11px;">阿里</a> <a href="/tags/%E9%9B%86%E5%90%88%E6%A1%86%E6%9E%B6/" style="font-size: 11px;">集合框架</a> <a href="/tags/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/" style="font-size: 11px;">面向对象</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/06/">June 2025</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/07/">July 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/06/">June 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/05/">May 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">January 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">March 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">February 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">January 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">October 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">September 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">July 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">June 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">May 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">April 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">March 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">January 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">December 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">August 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">June 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">May 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">April 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">March 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">December 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">October 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">September 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">August 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">July 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">June 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">May 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">April 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">March 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/">February 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/10/">October 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/04/">April 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/03/">March 2016</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2025/06/07/Java%20SE/Guava%20Cache%20%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90%E4%B8%8E%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/">(no title)</a>
          </li>
        
          <li>
            <a href="/2021/07/11/Spring/SpringFu%20DSL%20%E8%AE%BE%E8%AE%A1%E6%80%9D%E6%83%B3/">SpringFu DSL 设计思想</a>
          </li>
        
          <li>
            <a href="/2021/07/11/Spring/SpringFu%20%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B/">SpringFu 启动流程</a>
          </li>
        
          <li>
            <a href="/2021/07/10/Spring/%E7%94%A8%E5%87%BD%E6%95%B0%E5%86%99%20Spring%20%E9%A1%B9%E7%9B%AE%E4%BD%A0%E8%A7%81%E8%BF%87%E4%B9%88%20--SpringFu/">用函数写 Bean 你见过么</a>
          </li>
        
          <li>
            <a href="/2021/06/27/Tomcat/%E6%8F%AD%E7%A7%98%20Tomcat%EF%BC%88%E4%B8%80%EF%BC%89%20-%20%E5%90%AF%E5%8A%A8/">揭秘 Tomcat - 启动</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2025 John Doe<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>